{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# MOOC Course Design Optimization\n",
    "\n",
    "## - Learning Analytics on OULAD dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 209,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import sklearn\n",
    "\n",
    "from sklearn import preprocessing\n",
    "from sklearn.cluster import KMeans\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn import metrics\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Loading Raw data"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "Remark: put raw datasets in same folder as notebook"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Student demographics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 295,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>gender</th>\n",
       "      <th>region</th>\n",
       "      <th>highest_education</th>\n",
       "      <th>imd_band</th>\n",
       "      <th>age_band</th>\n",
       "      <th>num_of_prev_attempts</th>\n",
       "      <th>studied_credits</th>\n",
       "      <th>disability</th>\n",
       "      <th>final_result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>11391</td>\n",
       "      <td>M</td>\n",
       "      <td>East Anglian Region</td>\n",
       "      <td>HE Qualification</td>\n",
       "      <td>90-100%</td>\n",
       "      <td>55&lt;=</td>\n",
       "      <td>0</td>\n",
       "      <td>240</td>\n",
       "      <td>N</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>F</td>\n",
       "      <td>Scotland</td>\n",
       "      <td>HE Qualification</td>\n",
       "      <td>20-30%</td>\n",
       "      <td>35-55</td>\n",
       "      <td>0</td>\n",
       "      <td>60</td>\n",
       "      <td>N</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>30268</td>\n",
       "      <td>F</td>\n",
       "      <td>North Western Region</td>\n",
       "      <td>A Level or Equivalent</td>\n",
       "      <td>30-40%</td>\n",
       "      <td>35-55</td>\n",
       "      <td>0</td>\n",
       "      <td>60</td>\n",
       "      <td>Y</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>31604</td>\n",
       "      <td>F</td>\n",
       "      <td>South East Region</td>\n",
       "      <td>A Level or Equivalent</td>\n",
       "      <td>50-60%</td>\n",
       "      <td>35-55</td>\n",
       "      <td>0</td>\n",
       "      <td>60</td>\n",
       "      <td>N</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>32885</td>\n",
       "      <td>F</td>\n",
       "      <td>West Midlands Region</td>\n",
       "      <td>Lower Than A Level</td>\n",
       "      <td>50-60%</td>\n",
       "      <td>0-35</td>\n",
       "      <td>0</td>\n",
       "      <td>60</td>\n",
       "      <td>N</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  code_module code_presentation  id_student gender                region  \\\n",
       "0         AAA             2013J       11391      M   East Anglian Region   \n",
       "1         AAA             2013J       28400      F              Scotland   \n",
       "2         AAA             2013J       30268      F  North Western Region   \n",
       "3         AAA             2013J       31604      F     South East Region   \n",
       "4         AAA             2013J       32885      F  West Midlands Region   \n",
       "\n",
       "       highest_education imd_band age_band  num_of_prev_attempts  \\\n",
       "0       HE Qualification  90-100%     55<=                     0   \n",
       "1       HE Qualification   20-30%    35-55                     0   \n",
       "2  A Level or Equivalent   30-40%    35-55                     0   \n",
       "3  A Level or Equivalent   50-60%    35-55                     0   \n",
       "4     Lower Than A Level   50-60%     0-35                     0   \n",
       "\n",
       "   studied_credits disability final_result  \n",
       "0              240          N         Pass  \n",
       "1               60          N         Pass  \n",
       "2               60          Y    Withdrawn  \n",
       "3               60          N         Pass  \n",
       "4               60          N         Pass  "
      ]
     },
     "execution_count": 295,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_info = pd.read_csv('studentInfo.csv')\n",
    "student_info.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>gender</th>\n",
       "      <th>region</th>\n",
       "      <th>highest_education</th>\n",
       "      <th>imd_band</th>\n",
       "      <th>age_band</th>\n",
       "      <th>num_of_prev_attempts</th>\n",
       "      <th>studied_credits</th>\n",
       "      <th>disability</th>\n",
       "      <th>final_result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>32593</td>\n",
       "      <td>32593</td>\n",
       "      <td>3.259300e+04</td>\n",
       "      <td>32593</td>\n",
       "      <td>32593</td>\n",
       "      <td>32593</td>\n",
       "      <td>31482</td>\n",
       "      <td>32593</td>\n",
       "      <td>32593.000000</td>\n",
       "      <td>32593.000000</td>\n",
       "      <td>32593</td>\n",
       "      <td>32593</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>13</td>\n",
       "      <td>5</td>\n",
       "      <td>10</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2014J</td>\n",
       "      <td>NaN</td>\n",
       "      <td>M</td>\n",
       "      <td>Scotland</td>\n",
       "      <td>A Level or Equivalent</td>\n",
       "      <td>20-30%</td>\n",
       "      <td>0-35</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>N</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>7909</td>\n",
       "      <td>11260</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17875</td>\n",
       "      <td>3446</td>\n",
       "      <td>14045</td>\n",
       "      <td>3654</td>\n",
       "      <td>22944</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29429</td>\n",
       "      <td>12361</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.066877e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.163225</td>\n",
       "      <td>79.758691</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.491673e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.479758</td>\n",
       "      <td>41.071900</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.733000e+03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.085730e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>60.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.903100e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>60.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.444530e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>120.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.716795e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>655.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       code_module code_presentation    id_student gender    region  \\\n",
       "count        32593             32593  3.259300e+04  32593     32593   \n",
       "unique           7                 4           NaN      2        13   \n",
       "top            BBB             2014J           NaN      M  Scotland   \n",
       "freq          7909             11260           NaN  17875      3446   \n",
       "mean           NaN               NaN  7.066877e+05    NaN       NaN   \n",
       "std            NaN               NaN  5.491673e+05    NaN       NaN   \n",
       "min            NaN               NaN  3.733000e+03    NaN       NaN   \n",
       "25%            NaN               NaN  5.085730e+05    NaN       NaN   \n",
       "50%            NaN               NaN  5.903100e+05    NaN       NaN   \n",
       "75%            NaN               NaN  6.444530e+05    NaN       NaN   \n",
       "max            NaN               NaN  2.716795e+06    NaN       NaN   \n",
       "\n",
       "            highest_education imd_band age_band  num_of_prev_attempts  \\\n",
       "count                   32593    31482    32593          32593.000000   \n",
       "unique                      5       10        3                   NaN   \n",
       "top     A Level or Equivalent   20-30%     0-35                   NaN   \n",
       "freq                    14045     3654    22944                   NaN   \n",
       "mean                      NaN      NaN      NaN              0.163225   \n",
       "std                       NaN      NaN      NaN              0.479758   \n",
       "min                       NaN      NaN      NaN              0.000000   \n",
       "25%                       NaN      NaN      NaN              0.000000   \n",
       "50%                       NaN      NaN      NaN              0.000000   \n",
       "75%                       NaN      NaN      NaN              0.000000   \n",
       "max                       NaN      NaN      NaN              6.000000   \n",
       "\n",
       "        studied_credits disability final_result  \n",
       "count      32593.000000      32593        32593  \n",
       "unique              NaN          2            4  \n",
       "top                 NaN          N         Pass  \n",
       "freq                NaN      29429        12361  \n",
       "mean          79.758691        NaN          NaN  \n",
       "std           41.071900        NaN          NaN  \n",
       "min           30.000000        NaN          NaN  \n",
       "25%           60.000000        NaN          NaN  \n",
       "50%           60.000000        NaN          NaN  \n",
       "75%          120.000000        NaN          NaN  \n",
       "max          655.000000        NaN          NaN  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_info.describe(include='all')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Student activities"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>date_registration</th>\n",
       "      <th>date_unregistration</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>11391</td>\n",
       "      <td>-159.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>-53.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>30268</td>\n",
       "      <td>-92.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>31604</td>\n",
       "      <td>-52.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>32885</td>\n",
       "      <td>-176.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  code_module code_presentation  id_student  date_registration  \\\n",
       "0         AAA             2013J       11391             -159.0   \n",
       "1         AAA             2013J       28400              -53.0   \n",
       "2         AAA             2013J       30268              -92.0   \n",
       "3         AAA             2013J       31604              -52.0   \n",
       "4         AAA             2013J       32885             -176.0   \n",
       "\n",
       "   date_unregistration  \n",
       "0                  NaN  \n",
       "1                  NaN  \n",
       "2                 12.0  \n",
       "3                  NaN  \n",
       "4                  NaN  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# student regsitration\n",
    "student_reg = pd.read_csv('studentRegistration.csv')\n",
    "student_reg.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_assessment</th>\n",
       "      <th>id_student</th>\n",
       "      <th>date_submitted</th>\n",
       "      <th>is_banked</th>\n",
       "      <th>score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1752</td>\n",
       "      <td>11391</td>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>78.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1752</td>\n",
       "      <td>28400</td>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "      <td>70.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1752</td>\n",
       "      <td>31604</td>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>72.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1752</td>\n",
       "      <td>32885</td>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1752</td>\n",
       "      <td>38053</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>79.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_assessment  id_student  date_submitted  is_banked  score\n",
       "0           1752       11391              18          0   78.0\n",
       "1           1752       28400              22          0   70.0\n",
       "2           1752       31604              17          0   72.0\n",
       "3           1752       32885              26          0   69.0\n",
       "4           1752       38053              19          0   79.0"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# student assessment\n",
    "student_assess = pd.read_csv('studentAssessment.csv')\n",
    "student_assess.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>id_site</th>\n",
       "      <th>date</th>\n",
       "      <th>sum_click</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>546652</td>\n",
       "      <td>-10</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>546652</td>\n",
       "      <td>-10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>546652</td>\n",
       "      <td>-10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>546614</td>\n",
       "      <td>-10</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>28400</td>\n",
       "      <td>546714</td>\n",
       "      <td>-10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  code_module code_presentation  id_student  id_site  date  sum_click\n",
       "0         AAA             2013J       28400   546652   -10          4\n",
       "1         AAA             2013J       28400   546652   -10          1\n",
       "2         AAA             2013J       28400   546652   -10          1\n",
       "3         AAA             2013J       28400   546614   -10         11\n",
       "4         AAA             2013J       28400   546714   -10          1"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# student VLE - interation with virtual learning environment\n",
    "student_vle = pd.read_csv('studentVle.csv')\n",
    "student_vle.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>date_registration</th>\n",
       "      <th>date_unregistration</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>32593</td>\n",
       "      <td>32593</td>\n",
       "      <td>3.259300e+04</td>\n",
       "      <td>32548.000000</td>\n",
       "      <td>10072.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2014J</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>7909</td>\n",
       "      <td>11260</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.066877e+05</td>\n",
       "      <td>-69.411300</td>\n",
       "      <td>49.757645</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.491673e+05</td>\n",
       "      <td>49.260522</td>\n",
       "      <td>82.460890</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.733000e+03</td>\n",
       "      <td>-322.000000</td>\n",
       "      <td>-365.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.085730e+05</td>\n",
       "      <td>-100.000000</td>\n",
       "      <td>-2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.903100e+05</td>\n",
       "      <td>-57.000000</td>\n",
       "      <td>27.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.444530e+05</td>\n",
       "      <td>-29.000000</td>\n",
       "      <td>109.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.716795e+06</td>\n",
       "      <td>167.000000</td>\n",
       "      <td>444.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       code_module code_presentation    id_student  date_registration  \\\n",
       "count        32593             32593  3.259300e+04       32548.000000   \n",
       "unique           7                 4           NaN                NaN   \n",
       "top            BBB             2014J           NaN                NaN   \n",
       "freq          7909             11260           NaN                NaN   \n",
       "mean           NaN               NaN  7.066877e+05         -69.411300   \n",
       "std            NaN               NaN  5.491673e+05          49.260522   \n",
       "min            NaN               NaN  3.733000e+03        -322.000000   \n",
       "25%            NaN               NaN  5.085730e+05        -100.000000   \n",
       "50%            NaN               NaN  5.903100e+05         -57.000000   \n",
       "75%            NaN               NaN  6.444530e+05         -29.000000   \n",
       "max            NaN               NaN  2.716795e+06         167.000000   \n",
       "\n",
       "        date_unregistration  \n",
       "count          10072.000000  \n",
       "unique                  NaN  \n",
       "top                     NaN  \n",
       "freq                    NaN  \n",
       "mean              49.757645  \n",
       "std               82.460890  \n",
       "min             -365.000000  \n",
       "25%               -2.000000  \n",
       "50%               27.000000  \n",
       "75%              109.000000  \n",
       "max              444.000000  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_reg.describe(include='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_assessment</th>\n",
       "      <th>id_student</th>\n",
       "      <th>date_submitted</th>\n",
       "      <th>is_banked</th>\n",
       "      <th>score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>173912.000000</td>\n",
       "      <td>1.739120e+05</td>\n",
       "      <td>173912.000000</td>\n",
       "      <td>173912.000000</td>\n",
       "      <td>173739.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>26553.803556</td>\n",
       "      <td>7.051507e+05</td>\n",
       "      <td>116.032942</td>\n",
       "      <td>0.010977</td>\n",
       "      <td>75.799573</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>8829.784254</td>\n",
       "      <td>5.523952e+05</td>\n",
       "      <td>71.484148</td>\n",
       "      <td>0.104194</td>\n",
       "      <td>18.798107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1752.000000</td>\n",
       "      <td>6.516000e+03</td>\n",
       "      <td>-11.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>15022.000000</td>\n",
       "      <td>5.044290e+05</td>\n",
       "      <td>51.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>65.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>25359.000000</td>\n",
       "      <td>5.852080e+05</td>\n",
       "      <td>116.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>80.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>34883.000000</td>\n",
       "      <td>6.344980e+05</td>\n",
       "      <td>173.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>90.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>37443.000000</td>\n",
       "      <td>2.698588e+06</td>\n",
       "      <td>608.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id_assessment    id_student  date_submitted      is_banked  \\\n",
       "count  173912.000000  1.739120e+05   173912.000000  173912.000000   \n",
       "mean    26553.803556  7.051507e+05      116.032942       0.010977   \n",
       "std      8829.784254  5.523952e+05       71.484148       0.104194   \n",
       "min      1752.000000  6.516000e+03      -11.000000       0.000000   \n",
       "25%     15022.000000  5.044290e+05       51.000000       0.000000   \n",
       "50%     25359.000000  5.852080e+05      116.000000       0.000000   \n",
       "75%     34883.000000  6.344980e+05      173.000000       0.000000   \n",
       "max     37443.000000  2.698588e+06      608.000000       1.000000   \n",
       "\n",
       "               score  \n",
       "count  173739.000000  \n",
       "mean       75.799573  \n",
       "std        18.798107  \n",
       "min         0.000000  \n",
       "25%        65.000000  \n",
       "50%        80.000000  \n",
       "75%        90.000000  \n",
       "max       100.000000  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_assess.describe(include='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th>id_site</th>\n",
       "      <th>date</th>\n",
       "      <th>sum_click</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>10655280</td>\n",
       "      <td>10655280</td>\n",
       "      <td>1.065528e+07</td>\n",
       "      <td>1.065528e+07</td>\n",
       "      <td>1.065528e+07</td>\n",
       "      <td>1.065528e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>FFF</td>\n",
       "      <td>2014J</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>4014499</td>\n",
       "      <td>3619452</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.333336e+05</td>\n",
       "      <td>7.383234e+05</td>\n",
       "      <td>9.517400e+01</td>\n",
       "      <td>3.716946e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.827060e+05</td>\n",
       "      <td>1.312196e+05</td>\n",
       "      <td>7.607130e+01</td>\n",
       "      <td>8.849047e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.516000e+03</td>\n",
       "      <td>5.267210e+05</td>\n",
       "      <td>-2.500000e+01</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.077430e+05</td>\n",
       "      <td>6.735190e+05</td>\n",
       "      <td>2.500000e+01</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.882360e+05</td>\n",
       "      <td>7.300690e+05</td>\n",
       "      <td>8.600000e+01</td>\n",
       "      <td>2.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.464840e+05</td>\n",
       "      <td>8.770300e+05</td>\n",
       "      <td>1.560000e+02</td>\n",
       "      <td>3.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.698588e+06</td>\n",
       "      <td>1.049562e+06</td>\n",
       "      <td>2.690000e+02</td>\n",
       "      <td>6.977000e+03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       code_module code_presentation    id_student       id_site  \\\n",
       "count     10655280          10655280  1.065528e+07  1.065528e+07   \n",
       "unique           7                 4           NaN           NaN   \n",
       "top            FFF             2014J           NaN           NaN   \n",
       "freq       4014499           3619452           NaN           NaN   \n",
       "mean           NaN               NaN  7.333336e+05  7.383234e+05   \n",
       "std            NaN               NaN  5.827060e+05  1.312196e+05   \n",
       "min            NaN               NaN  6.516000e+03  5.267210e+05   \n",
       "25%            NaN               NaN  5.077430e+05  6.735190e+05   \n",
       "50%            NaN               NaN  5.882360e+05  7.300690e+05   \n",
       "75%            NaN               NaN  6.464840e+05  8.770300e+05   \n",
       "max            NaN               NaN  2.698588e+06  1.049562e+06   \n",
       "\n",
       "                date     sum_click  \n",
       "count   1.065528e+07  1.065528e+07  \n",
       "unique           NaN           NaN  \n",
       "top              NaN           NaN  \n",
       "freq             NaN           NaN  \n",
       "mean    9.517400e+01  3.716946e+00  \n",
       "std     7.607130e+01  8.849047e+00  \n",
       "min    -2.500000e+01  1.000000e+00  \n",
       "25%     2.500000e+01  1.000000e+00  \n",
       "50%     8.600000e+01  2.000000e+00  \n",
       "75%     1.560000e+02  3.000000e+00  \n",
       "max     2.690000e+02  6.977000e+03  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_vle.describe(include='all')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Course information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>module_presentation_length</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2014J</td>\n",
       "      <td>269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2013J</td>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2014J</td>\n",
       "      <td>262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2013B</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>BBB</td>\n",
       "      <td>2014B</td>\n",
       "      <td>234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>CCC</td>\n",
       "      <td>2014J</td>\n",
       "      <td>269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>CCC</td>\n",
       "      <td>2014B</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>DDD</td>\n",
       "      <td>2013J</td>\n",
       "      <td>261</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>DDD</td>\n",
       "      <td>2014J</td>\n",
       "      <td>262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>DDD</td>\n",
       "      <td>2013B</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>DDD</td>\n",
       "      <td>2014B</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>EEE</td>\n",
       "      <td>2013J</td>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>EEE</td>\n",
       "      <td>2014J</td>\n",
       "      <td>269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>EEE</td>\n",
       "      <td>2014B</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>FFF</td>\n",
       "      <td>2013J</td>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>FFF</td>\n",
       "      <td>2014J</td>\n",
       "      <td>269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>FFF</td>\n",
       "      <td>2013B</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>FFF</td>\n",
       "      <td>2014B</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>GGG</td>\n",
       "      <td>2013J</td>\n",
       "      <td>261</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>GGG</td>\n",
       "      <td>2014J</td>\n",
       "      <td>269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>GGG</td>\n",
       "      <td>2014B</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   code_module code_presentation  module_presentation_length\n",
       "0          AAA             2013J                         268\n",
       "1          AAA             2014J                         269\n",
       "2          BBB             2013J                         268\n",
       "3          BBB             2014J                         262\n",
       "4          BBB             2013B                         240\n",
       "5          BBB             2014B                         234\n",
       "6          CCC             2014J                         269\n",
       "7          CCC             2014B                         241\n",
       "8          DDD             2013J                         261\n",
       "9          DDD             2014J                         262\n",
       "10         DDD             2013B                         240\n",
       "11         DDD             2014B                         241\n",
       "12         EEE             2013J                         268\n",
       "13         EEE             2014J                         269\n",
       "14         EEE             2014B                         241\n",
       "15         FFF             2013J                         268\n",
       "16         FFF             2014J                         269\n",
       "17         FFF             2013B                         240\n",
       "18         FFF             2014B                         241\n",
       "19         GGG             2013J                         261\n",
       "20         GGG             2014J                         269\n",
       "21         GGG             2014B                         241"
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# course basic info\n",
    "course_basic = pd.read_csv('courses.csv')\n",
    "course_basic"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_assessment</th>\n",
       "      <th>assessment_type</th>\n",
       "      <th>date</th>\n",
       "      <th>weight</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>1752</td>\n",
       "      <td>TMA</td>\n",
       "      <td>19.0</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>1753</td>\n",
       "      <td>TMA</td>\n",
       "      <td>54.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>1754</td>\n",
       "      <td>TMA</td>\n",
       "      <td>117.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>1755</td>\n",
       "      <td>TMA</td>\n",
       "      <td>166.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>1756</td>\n",
       "      <td>TMA</td>\n",
       "      <td>215.0</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  code_module code_presentation  id_assessment assessment_type   date  weight\n",
       "0         AAA             2013J           1752             TMA   19.0    10.0\n",
       "1         AAA             2013J           1753             TMA   54.0    20.0\n",
       "2         AAA             2013J           1754             TMA  117.0    20.0\n",
       "3         AAA             2013J           1755             TMA  166.0    20.0\n",
       "4         AAA             2013J           1756             TMA  215.0    30.0"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# course assessments\n",
    "course_assess = pd.read_csv('assessments.csv')\n",
    "course_assess.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_site</th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>activity_type</th>\n",
       "      <th>week_from</th>\n",
       "      <th>week_to</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>546943</td>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>resource</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>546712</td>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>oucontent</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>546998</td>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>resource</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>546888</td>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>url</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>547035</td>\n",
       "      <td>AAA</td>\n",
       "      <td>2013J</td>\n",
       "      <td>resource</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_site code_module code_presentation activity_type  week_from  week_to\n",
       "0   546943         AAA             2013J      resource        NaN      NaN\n",
       "1   546712         AAA             2013J     oucontent        NaN      NaN\n",
       "2   546998         AAA             2013J      resource        NaN      NaN\n",
       "3   546888         AAA             2013J           url        NaN      NaN\n",
       "4   547035         AAA             2013J      resource        NaN      NaN"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# course materials\n",
    "course_vle = pd.read_csv('vle.csv')\n",
    "course_vle.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_site</th>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>activity_type</th>\n",
       "      <th>week_from</th>\n",
       "      <th>week_to</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>6.364000e+03</td>\n",
       "      <td>6364</td>\n",
       "      <td>6364</td>\n",
       "      <td>6364</td>\n",
       "      <td>1121.000000</td>\n",
       "      <td>1121.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>NaN</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>NaN</td>\n",
       "      <td>FFF</td>\n",
       "      <td>2013J</td>\n",
       "      <td>resource</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1967</td>\n",
       "      <td>1772</td>\n",
       "      <td>2660</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>7.260991e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.204282</td>\n",
       "      <td>15.214987</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.283151e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8.792865</td>\n",
       "      <td>8.779806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>5.267210e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>6.615928e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>7.300965e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.000000</td>\n",
       "      <td>15.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>8.140162e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>22.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.077905e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>29.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             id_site code_module code_presentation activity_type    week_from  \\\n",
       "count   6.364000e+03        6364              6364          6364  1121.000000   \n",
       "unique           NaN           7                 4            20          NaN   \n",
       "top              NaN         FFF             2013J      resource          NaN   \n",
       "freq             NaN        1967              1772          2660          NaN   \n",
       "mean    7.260991e+05         NaN               NaN           NaN    15.204282   \n",
       "std     1.283151e+05         NaN               NaN           NaN     8.792865   \n",
       "min     5.267210e+05         NaN               NaN           NaN     0.000000   \n",
       "25%     6.615928e+05         NaN               NaN           NaN     8.000000   \n",
       "50%     7.300965e+05         NaN               NaN           NaN    15.000000   \n",
       "75%     8.140162e+05         NaN               NaN           NaN    22.000000   \n",
       "max     1.077905e+06         NaN               NaN           NaN    29.000000   \n",
       "\n",
       "            week_to  \n",
       "count   1121.000000  \n",
       "unique          NaN  \n",
       "top             NaN  \n",
       "freq            NaN  \n",
       "mean      15.214987  \n",
       "std        8.779806  \n",
       "min        0.000000  \n",
       "25%        8.000000  \n",
       "50%       15.000000  \n",
       "75%       22.000000  \n",
       "max       29.000000  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "course_vle.describe(include='all')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data processing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Student demographics information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 308,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['90-100%', '20-30%', '30-40%', '50-60%', '80-90%', '70-80%',\n",
       "       '60-70%', '40-50%', '10-20%', '0-10%'], dtype=object)"
      ]
     },
     "execution_count": 308,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "student_info_base['imd_band'] = student_info_base['imd_band'].apply(lambda x: '10-20%' if x=='10-20' \n",
    "                                                                    or x=='20-Oct' else x)\n",
    "student_info_base.dropna(subset=['imd_band'],inplace=True)\n",
    "student_info_base['imd_band'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 311,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2963: FutureWarning: specifying 'categories' or 'ordered' in .astype() is deprecated; pass a CategoricalDtype instead\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0        90-100%\n",
       "1         20-30%\n",
       "2         30-40%\n",
       "3         50-60%\n",
       "4         50-60%\n",
       "5         80-90%\n",
       "6         30-40%\n",
       "7        90-100%\n",
       "8         70-80%\n",
       "10        70-80%\n",
       "11        20-30%\n",
       "12        60-70%\n",
       "13        50-60%\n",
       "14        40-50%\n",
       "15        70-80%\n",
       "16        60-70%\n",
       "18        10-20%\n",
       "19        30-40%\n",
       "20        30-40%\n",
       "21         0-10%\n",
       "22        70-80%\n",
       "23        70-80%\n",
       "24        20-30%\n",
       "25        80-90%\n",
       "26        30-40%\n",
       "27        60-70%\n",
       "29        80-90%\n",
       "30        20-30%\n",
       "31        80-90%\n",
       "32       90-100%\n",
       "          ...   \n",
       "32563     40-50%\n",
       "32564     50-60%\n",
       "32565     50-60%\n",
       "32566     50-60%\n",
       "32567     20-30%\n",
       "32568     80-90%\n",
       "32569     70-80%\n",
       "32570     50-60%\n",
       "32571     20-30%\n",
       "32572     60-70%\n",
       "32573     30-40%\n",
       "32574      0-10%\n",
       "32575     30-40%\n",
       "32576      0-10%\n",
       "32577     80-90%\n",
       "32578     40-50%\n",
       "32579     20-30%\n",
       "32580     30-40%\n",
       "32581     70-80%\n",
       "32582     40-50%\n",
       "32583     10-20%\n",
       "32584     10-20%\n",
       "32585     80-90%\n",
       "32586     60-70%\n",
       "32587     80-90%\n",
       "32588     10-20%\n",
       "32589     40-50%\n",
       "32590     20-30%\n",
       "32591    90-100%\n",
       "32592     50-60%\n",
       "Name: imd_band, Length: 31482, dtype: category\n",
       "Categories (10, object): [0-10% < 10-20% < 20-30% < 30-40% ... 60-70% < 70-80% < 80-90% < 90-100%]"
      ]
     },
     "execution_count": 311,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ordered_imbband = ['0-10%','10-20%','20-30%', '30-40%', '40-50%',\n",
    "                   '50-60%','60-70%',  '70-80%','80-90%','90-100%']\n",
    "student_info_base['imd_band'] = student_info_base['imd_band'].astype(\"category\",\n",
    "                                                ordered=True,categories=ordered_imbband)\n",
    "student_info_base['imd_band']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 312,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2963: FutureWarning: specifying 'categories' or 'ordered' in .astype() is deprecated; pass a CategoricalDtype instead\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    }
   ],
   "source": [
    "# imd_band - ordinal\n",
    "student_info_base = student_info.copy()\n",
    "student_info_base['imd_band'] = student_info_base['imd_band'].apply(lambda x: '10-20%' if x=='10-20' \n",
    "                                                                    or x=='20-Oct' else x)\n",
    "ordered_imbband = ['0-10%','10-20%','20-30%', '30-40%', '40-50%',\n",
    "                   '50-60%','60-70%',  '70-80%','80-90%','90-100%']\n",
    "student_info_base['imd_band'] = student_info_base['imd_band'].astype(\"category\",\n",
    "                                                ordered=True,categories=ordered_imbband)\n",
    "                                      \n",
    "# education level - ordinal\n",
    "ordered_education = ['No Formal quals','Lower Than A Level',\n",
    "                     'A Level or Equivalent','HE Qualification','Post Graduate Qualification']\n",
    "student_info_base['highest_education'] = student_info_base['highest_education'].astype(\"category\",\n",
    "                                                        ordered=True,categories=ordered_education)\n",
    "\n",
    "# age band - ordinal\n",
    "ordered_ageband = ['0-35','35-55','55<=']\n",
    "student_info_base['age_band'] = student_info_base['age_band'].astype(\"category\",\n",
    "                                                        ordered=True,categories=ordered_ageband)\n",
    "\n",
    "# generate feature df\n",
    "student_info_feature = student_info_base.copy()\n",
    "# encode categorical feature to numeric\n",
    "student_info_feature['highest_education'] = student_info_feature['highest_education'].cat.codes\n",
    "student_info_feature['age_band'] = student_info_feature['age_band'].cat.codes\n",
    "student_info_base['imd_band'] = student_info_feature['imd_band'].cat.codes\n",
    "# final result - combine pass and distinct to pass\n",
    "student_info_feature['final_result'].where(student_info_feature['final_result']!='Distinction',\n",
    "                                           'Pass',inplace=True)\n",
    "# One Hot Encoding\n",
    "# Male 1, Female 0\n",
    "student_info_feature['gender'] = student_info_feature['gender'].apply(lambda x: 0 if x == 'F' else 1)\n",
    "# Disable 1, Not disable 0\n",
    "student_info_feature['disability'] = student_info_feature['disability'].apply(lambda x: 0 if x == 'N' else 1)\n",
    "# OHE regions (drop first to avoid duplicates)\n",
    "student_info_feature = pd.concat([student_info_feature,pd.get_dummies(student_info_feature['region'],\n",
    "                                  drop_first=True,prefix='region')],axis=1)\n",
    "student_info_feature.drop(['region'],axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>highest_education</th>\n",
       "      <th>age_band</th>\n",
       "      <th>num_of_prev_attempts</th>\n",
       "      <th>disability</th>\n",
       "      <th>region_East Midlands Region</th>\n",
       "      <th>region_Ireland</th>\n",
       "      <th>region_London Region</th>\n",
       "      <th>region_North Region</th>\n",
       "      <th>region_North Western Region</th>\n",
       "      <th>region_Scotland</th>\n",
       "      <th>region_South East Region</th>\n",
       "      <th>region_South Region</th>\n",
       "      <th>region_South West Region</th>\n",
       "      <th>region_Wales</th>\n",
       "      <th>region_West Midlands Region</th>\n",
       "      <th>region_Yorkshire Region</th>\n",
       "      <th>final_result</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">AAA</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2013J</th>\n",
       "      <th>11391</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28400</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30268</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31604</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32885</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38053</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45462</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45642</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52130</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53025</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57506</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58873</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59185</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62155</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63400</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65002</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70464</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71361</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74372</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Fail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75091</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77367</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91265</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94961</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98094</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100893</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101781</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102806</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102952</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104476</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106247</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">GGG</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2014J</th>\n",
       "      <th>1950911</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1977701</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2004143</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2052942</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2053521</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2203216</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2214722</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2239862</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2268380</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2270562</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2271766</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2282141</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2311714</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2338614</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2342238</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2357806</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2373245</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2378591</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Fail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2456431</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Fail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2475886</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Fail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2508153</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2533195</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2606765</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608143</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2620947</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2640965</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Fail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2645731</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2648187</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2679821</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Withdrawn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2684003</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>Pass</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32593 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          gender  highest_education  age_band  \\\n",
       "code_module code_presentation id_student                                        \n",
       "AAA         2013J             11391            1                  3         2   \n",
       "                              28400            0                  3         1   \n",
       "                              30268            0                  2         1   \n",
       "                              31604            0                  2         1   \n",
       "                              32885            0                  1         0   \n",
       "                              38053            1                  2         1   \n",
       "                              45462            1                  3         0   \n",
       "                              45642            0                  2         0   \n",
       "                              52130            0                  2         0   \n",
       "                              53025            1                  4         2   \n",
       "                              57506            1                  1         1   \n",
       "                              58873            0                  2         0   \n",
       "                              59185            1                  1         1   \n",
       "                              62155            0                  3         0   \n",
       "                              63400            1                  1         1   \n",
       "                              65002            0                  2         0   \n",
       "                              70464            0                  2         1   \n",
       "                              71361            1                  3         1   \n",
       "                              74372            1                  2         1   \n",
       "                              75091            1                  2         1   \n",
       "                              77367            1                  2         0   \n",
       "                              91265            1                  3         0   \n",
       "                              94961            1                  1         1   \n",
       "                              98094            1                  1         1   \n",
       "                              100893           1                  2         0   \n",
       "                              101781           1                  1         1   \n",
       "                              102806           1                  2         0   \n",
       "                              102952           1                  3         0   \n",
       "                              104476           1                  4         1   \n",
       "                              106247           1                  3         1   \n",
       "...                                          ...                ...       ...   \n",
       "GGG         2014J             1950911          0                  1         1   \n",
       "                              1977701          0                  1         1   \n",
       "                              2004143          0                  1         0   \n",
       "                              2052942          0                  1         1   \n",
       "                              2053521          0                  2         1   \n",
       "                              2203216          0                  2         1   \n",
       "                              2214722          0                  2         1   \n",
       "                              2239862          1                  1         1   \n",
       "                              2268380          0                  1         1   \n",
       "                              2270562          0                  1         1   \n",
       "                              2271766          0                  2         1   \n",
       "                              2282141          1                  2         1   \n",
       "                              2311714          0                  1         1   \n",
       "                              2338614          0                  2         1   \n",
       "                              2342238          1                  3         0   \n",
       "                              2357806          0                  1         1   \n",
       "                              2373245          1                  1         1   \n",
       "                              2378591          0                  2         1   \n",
       "                              2456431          0                  1         0   \n",
       "                              2475886          0                  1         1   \n",
       "                              2508153          0                  1         0   \n",
       "                              2533195          0                  1         0   \n",
       "                              2606765          0                  1         0   \n",
       "                              2608143          1                  3         1   \n",
       "                              2620947          0                  2         0   \n",
       "                              2640965          0                  1         0   \n",
       "                              2645731          0                  1         1   \n",
       "                              2648187          0                  2         0   \n",
       "                              2679821          0                  1         1   \n",
       "                              2684003          0                  3         1   \n",
       "\n",
       "                                          num_of_prev_attempts  disability  \\\n",
       "code_module code_presentation id_student                                     \n",
       "AAA         2013J             11391                          0           0   \n",
       "                              28400                          0           0   \n",
       "                              30268                          0           1   \n",
       "                              31604                          0           0   \n",
       "                              32885                          0           0   \n",
       "                              38053                          0           0   \n",
       "                              45462                          0           0   \n",
       "                              45642                          0           0   \n",
       "                              52130                          0           0   \n",
       "                              53025                          0           0   \n",
       "                              57506                          0           0   \n",
       "                              58873                          0           0   \n",
       "                              59185                          0           0   \n",
       "                              62155                          0           0   \n",
       "                              63400                          0           0   \n",
       "                              65002                          0           0   \n",
       "                              70464                          0           0   \n",
       "                              71361                          0           0   \n",
       "                              74372                          0           0   \n",
       "                              75091                          0           0   \n",
       "                              77367                          0           0   \n",
       "                              91265                          0           0   \n",
       "                              94961                          0           0   \n",
       "                              98094                          0           0   \n",
       "                              100893                         0           0   \n",
       "                              101781                         0           0   \n",
       "                              102806                         0           0   \n",
       "                              102952                         0           0   \n",
       "                              104476                         0           0   \n",
       "                              106247                         0           0   \n",
       "...                                                        ...         ...   \n",
       "GGG         2014J             1950911                        0           0   \n",
       "                              1977701                        0           0   \n",
       "                              2004143                        0           0   \n",
       "                              2052942                        0           0   \n",
       "                              2053521                        1           1   \n",
       "                              2203216                        0           0   \n",
       "                              2214722                        0           0   \n",
       "                              2239862                        0           0   \n",
       "                              2268380                        0           0   \n",
       "                              2270562                        0           0   \n",
       "                              2271766                        0           0   \n",
       "                              2282141                        0           0   \n",
       "                              2311714                        0           0   \n",
       "                              2338614                        0           1   \n",
       "                              2342238                        0           0   \n",
       "                              2357806                        0           0   \n",
       "                              2373245                        0           0   \n",
       "                              2378591                        1           0   \n",
       "                              2456431                        0           1   \n",
       "                              2475886                        0           0   \n",
       "                              2508153                        0           0   \n",
       "                              2533195                        0           0   \n",
       "                              2606765                        0           0   \n",
       "                              2608143                        0           0   \n",
       "                              2620947                        0           1   \n",
       "                              2640965                        0           0   \n",
       "                              2645731                        0           0   \n",
       "                              2648187                        0           1   \n",
       "                              2679821                        0           0   \n",
       "                              2684003                        0           0   \n",
       "\n",
       "                                          region_East Midlands Region  \\\n",
       "code_module code_presentation id_student                                \n",
       "AAA         2013J             11391                                 0   \n",
       "                              28400                                 0   \n",
       "                              30268                                 0   \n",
       "                              31604                                 0   \n",
       "                              32885                                 0   \n",
       "                              38053                                 0   \n",
       "                              45462                                 0   \n",
       "                              45642                                 0   \n",
       "                              52130                                 0   \n",
       "                              53025                                 0   \n",
       "                              57506                                 0   \n",
       "                              58873                                 0   \n",
       "                              59185                                 0   \n",
       "                              62155                                 0   \n",
       "                              63400                                 0   \n",
       "                              65002                                 0   \n",
       "                              70464                                 0   \n",
       "                              71361                                 0   \n",
       "                              74372                                 0   \n",
       "                              75091                                 0   \n",
       "                              77367                                 1   \n",
       "                              91265                                 0   \n",
       "                              94961                                 0   \n",
       "                              98094                                 0   \n",
       "                              100893                                0   \n",
       "                              101781                                0   \n",
       "                              102806                                0   \n",
       "                              102952                                0   \n",
       "                              104476                                0   \n",
       "                              106247                                0   \n",
       "...                                                               ...   \n",
       "GGG         2014J             1950911                               0   \n",
       "                              1977701                               0   \n",
       "                              2004143                               0   \n",
       "                              2052942                               0   \n",
       "                              2053521                               0   \n",
       "                              2203216                               0   \n",
       "                              2214722                               0   \n",
       "                              2239862                               0   \n",
       "                              2268380                               0   \n",
       "                              2270562                               0   \n",
       "                              2271766                               0   \n",
       "                              2282141                               0   \n",
       "                              2311714                               0   \n",
       "                              2338614                               0   \n",
       "                              2342238                               0   \n",
       "                              2357806                               0   \n",
       "                              2373245                               1   \n",
       "                              2378591                               0   \n",
       "                              2456431                               0   \n",
       "                              2475886                               0   \n",
       "                              2508153                               1   \n",
       "                              2533195                               0   \n",
       "                              2606765                               0   \n",
       "                              2608143                               1   \n",
       "                              2620947                               0   \n",
       "                              2640965                               0   \n",
       "                              2645731                               0   \n",
       "                              2648187                               0   \n",
       "                              2679821                               0   \n",
       "                              2684003                               0   \n",
       "\n",
       "                                          region_Ireland  \\\n",
       "code_module code_presentation id_student                   \n",
       "AAA         2013J             11391                    0   \n",
       "                              28400                    0   \n",
       "                              30268                    0   \n",
       "                              31604                    0   \n",
       "                              32885                    0   \n",
       "                              38053                    0   \n",
       "                              45462                    0   \n",
       "                              45642                    0   \n",
       "                              52130                    0   \n",
       "                              53025                    0   \n",
       "                              57506                    0   \n",
       "                              58873                    0   \n",
       "                              59185                    0   \n",
       "                              62155                    0   \n",
       "                              63400                    0   \n",
       "                              65002                    0   \n",
       "                              70464                    0   \n",
       "                              71361                    1   \n",
       "                              74372                    0   \n",
       "                              75091                    0   \n",
       "                              77367                    0   \n",
       "                              91265                    0   \n",
       "                              94961                    0   \n",
       "                              98094                    0   \n",
       "                              100893                   0   \n",
       "                              101781                   0   \n",
       "                              102806                   0   \n",
       "                              102952                   0   \n",
       "                              104476                   1   \n",
       "                              106247                   0   \n",
       "...                                                  ...   \n",
       "GGG         2014J             1950911                  0   \n",
       "                              1977701                  0   \n",
       "                              2004143                  0   \n",
       "                              2052942                  0   \n",
       "                              2053521                  0   \n",
       "                              2203216                  0   \n",
       "                              2214722                  0   \n",
       "                              2239862                  0   \n",
       "                              2268380                  0   \n",
       "                              2270562                  0   \n",
       "                              2271766                  0   \n",
       "                              2282141                  0   \n",
       "                              2311714                  0   \n",
       "                              2338614                  0   \n",
       "                              2342238                  1   \n",
       "                              2357806                  1   \n",
       "                              2373245                  0   \n",
       "                              2378591                  0   \n",
       "                              2456431                  0   \n",
       "                              2475886                  0   \n",
       "                              2508153                  0   \n",
       "                              2533195                  0   \n",
       "                              2606765                  0   \n",
       "                              2608143                  0   \n",
       "                              2620947                  0   \n",
       "                              2640965                  0   \n",
       "                              2645731                  0   \n",
       "                              2648187                  0   \n",
       "                              2679821                  0   \n",
       "                              2684003                  0   \n",
       "\n",
       "                                          region_London Region  \\\n",
       "code_module code_presentation id_student                         \n",
       "AAA         2013J             11391                          0   \n",
       "                              28400                          0   \n",
       "                              30268                          0   \n",
       "                              31604                          0   \n",
       "                              32885                          0   \n",
       "                              38053                          0   \n",
       "                              45462                          0   \n",
       "                              45642                          0   \n",
       "                              52130                          0   \n",
       "                              53025                          0   \n",
       "                              57506                          0   \n",
       "                              58873                          0   \n",
       "                              59185                          0   \n",
       "                              62155                          0   \n",
       "                              63400                          0   \n",
       "                              65002                          0   \n",
       "                              70464                          0   \n",
       "                              71361                          0   \n",
       "                              74372                          0   \n",
       "                              75091                          0   \n",
       "                              77367                          0   \n",
       "                              91265                          0   \n",
       "                              94961                          0   \n",
       "                              98094                          0   \n",
       "                              100893                         0   \n",
       "                              101781                         0   \n",
       "                              102806                         0   \n",
       "                              102952                         1   \n",
       "                              104476                         0   \n",
       "                              106247                         0   \n",
       "...                                                        ...   \n",
       "GGG         2014J             1950911                        0   \n",
       "                              1977701                        0   \n",
       "                              2004143                        0   \n",
       "                              2052942                        0   \n",
       "                              2053521                        0   \n",
       "                              2203216                        0   \n",
       "                              2214722                        0   \n",
       "                              2239862                        0   \n",
       "                              2268380                        0   \n",
       "                              2270562                        0   \n",
       "                              2271766                        1   \n",
       "                              2282141                        0   \n",
       "                              2311714                        1   \n",
       "                              2338614                        0   \n",
       "                              2342238                        0   \n",
       "                              2357806                        0   \n",
       "                              2373245                        0   \n",
       "                              2378591                        0   \n",
       "                              2456431                        0   \n",
       "                              2475886                        0   \n",
       "                              2508153                        0   \n",
       "                              2533195                        0   \n",
       "                              2606765                        1   \n",
       "                              2608143                        0   \n",
       "                              2620947                        0   \n",
       "                              2640965                        0   \n",
       "                              2645731                        0   \n",
       "                              2648187                        0   \n",
       "                              2679821                        0   \n",
       "                              2684003                        0   \n",
       "\n",
       "                                          region_North Region  \\\n",
       "code_module code_presentation id_student                        \n",
       "AAA         2013J             11391                         0   \n",
       "                              28400                         0   \n",
       "                              30268                         0   \n",
       "                              31604                         0   \n",
       "                              32885                         0   \n",
       "                              38053                         0   \n",
       "                              45462                         0   \n",
       "                              45642                         0   \n",
       "                              52130                         0   \n",
       "                              53025                         1   \n",
       "                              57506                         0   \n",
       "                              58873                         0   \n",
       "                              59185                         0   \n",
       "                              62155                         0   \n",
       "                              63400                         0   \n",
       "                              65002                         0   \n",
       "                              70464                         0   \n",
       "                              71361                         0   \n",
       "                              74372                         0   \n",
       "                              75091                         0   \n",
       "                              77367                         0   \n",
       "                              91265                         0   \n",
       "                              94961                         0   \n",
       "                              98094                         0   \n",
       "                              100893                        0   \n",
       "                              101781                        0   \n",
       "                              102806                        0   \n",
       "                              102952                        0   \n",
       "                              104476                        0   \n",
       "                              106247                        0   \n",
       "...                                                       ...   \n",
       "GGG         2014J             1950911                       0   \n",
       "                              1977701                       0   \n",
       "                              2004143                       0   \n",
       "                              2052942                       0   \n",
       "                              2053521                       0   \n",
       "                              2203216                       0   \n",
       "                              2214722                       0   \n",
       "                              2239862                       0   \n",
       "                              2268380                       0   \n",
       "                              2270562                       0   \n",
       "                              2271766                       0   \n",
       "                              2282141                       0   \n",
       "                              2311714                       0   \n",
       "                              2338614                       0   \n",
       "                              2342238                       0   \n",
       "                              2357806                       0   \n",
       "                              2373245                       0   \n",
       "                              2378591                       0   \n",
       "                              2456431                       0   \n",
       "                              2475886                       0   \n",
       "                              2508153                       0   \n",
       "                              2533195                       0   \n",
       "                              2606765                       0   \n",
       "                              2608143                       0   \n",
       "                              2620947                       0   \n",
       "                              2640965                       0   \n",
       "                              2645731                       0   \n",
       "                              2648187                       0   \n",
       "                              2679821                       0   \n",
       "                              2684003                       0   \n",
       "\n",
       "                                          region_North Western Region  \\\n",
       "code_module code_presentation id_student                                \n",
       "AAA         2013J             11391                                 0   \n",
       "                              28400                                 0   \n",
       "                              30268                                 1   \n",
       "                              31604                                 0   \n",
       "                              32885                                 0   \n",
       "                              38053                                 0   \n",
       "                              45462                                 0   \n",
       "                              45642                                 1   \n",
       "                              52130                                 0   \n",
       "                              53025                                 0   \n",
       "                              57506                                 0   \n",
       "                              58873                                 0   \n",
       "                              59185                                 0   \n",
       "                              62155                                 1   \n",
       "                              63400                                 0   \n",
       "                              65002                                 0   \n",
       "                              70464                                 0   \n",
       "                              71361                                 0   \n",
       "                              74372                                 0   \n",
       "                              75091                                 0   \n",
       "                              77367                                 0   \n",
       "                              91265                                 1   \n",
       "                              94961                                 0   \n",
       "                              98094                                 0   \n",
       "                              100893                                0   \n",
       "                              101781                                0   \n",
       "                              102806                                1   \n",
       "                              102952                                0   \n",
       "                              104476                                0   \n",
       "                              106247                                0   \n",
       "...                                                               ...   \n",
       "GGG         2014J             1950911                               0   \n",
       "                              1977701                               0   \n",
       "                              2004143                               0   \n",
       "                              2052942                               0   \n",
       "                              2053521                               0   \n",
       "                              2203216                               0   \n",
       "                              2214722                               0   \n",
       "                              2239862                               1   \n",
       "                              2268380                               0   \n",
       "                              2270562                               0   \n",
       "                              2271766                               0   \n",
       "                              2282141                               0   \n",
       "                              2311714                               0   \n",
       "                              2338614                               0   \n",
       "                              2342238                               0   \n",
       "                              2357806                               0   \n",
       "                              2373245                               0   \n",
       "                              2378591                               0   \n",
       "                              2456431                               0   \n",
       "                              2475886                               0   \n",
       "                              2508153                               0   \n",
       "                              2533195                               0   \n",
       "                              2606765                               0   \n",
       "                              2608143                               0   \n",
       "                              2620947                               0   \n",
       "                              2640965                               0   \n",
       "                              2645731                               0   \n",
       "                              2648187                               0   \n",
       "                              2679821                               0   \n",
       "                              2684003                               0   \n",
       "\n",
       "                                          region_Scotland  \\\n",
       "code_module code_presentation id_student                    \n",
       "AAA         2013J             11391                     0   \n",
       "                              28400                     1   \n",
       "                              30268                     0   \n",
       "                              31604                     0   \n",
       "                              32885                     0   \n",
       "                              38053                     0   \n",
       "                              45462                     1   \n",
       "                              45642                     0   \n",
       "                              52130                     0   \n",
       "                              53025                     0   \n",
       "                              57506                     0   \n",
       "                              58873                     0   \n",
       "                              59185                     0   \n",
       "                              62155                     0   \n",
       "                              63400                     1   \n",
       "                              65002                     0   \n",
       "                              70464                     0   \n",
       "                              71361                     0   \n",
       "                              74372                     0   \n",
       "                              75091                     0   \n",
       "                              77367                     0   \n",
       "                              91265                     0   \n",
       "                              94961                     0   \n",
       "                              98094                     0   \n",
       "                              100893                    0   \n",
       "                              101781                    0   \n",
       "                              102806                    0   \n",
       "                              102952                    0   \n",
       "                              104476                    0   \n",
       "                              106247                    0   \n",
       "...                                                   ...   \n",
       "GGG         2014J             1950911                   0   \n",
       "                              1977701                   0   \n",
       "                              2004143                   0   \n",
       "                              2052942                   1   \n",
       "                              2053521                   0   \n",
       "                              2203216                   0   \n",
       "                              2214722                   1   \n",
       "                              2239862                   0   \n",
       "                              2268380                   1   \n",
       "                              2270562                   0   \n",
       "                              2271766                   0   \n",
       "                              2282141                   0   \n",
       "                              2311714                   0   \n",
       "                              2338614                   1   \n",
       "                              2342238                   0   \n",
       "                              2357806                   0   \n",
       "                              2373245                   0   \n",
       "                              2378591                   0   \n",
       "                              2456431                   0   \n",
       "                              2475886                   0   \n",
       "                              2508153                   0   \n",
       "                              2533195                   0   \n",
       "                              2606765                   0   \n",
       "                              2608143                   0   \n",
       "                              2620947                   1   \n",
       "                              2640965                   0   \n",
       "                              2645731                   0   \n",
       "                              2648187                   0   \n",
       "                              2679821                   0   \n",
       "                              2684003                   0   \n",
       "\n",
       "                                          region_South East Region  \\\n",
       "code_module code_presentation id_student                             \n",
       "AAA         2013J             11391                              0   \n",
       "                              28400                              0   \n",
       "                              30268                              0   \n",
       "                              31604                              1   \n",
       "                              32885                              0   \n",
       "                              38053                              0   \n",
       "                              45462                              0   \n",
       "                              45642                              0   \n",
       "                              52130                              0   \n",
       "                              53025                              0   \n",
       "                              57506                              0   \n",
       "                              58873                              0   \n",
       "                              59185                              0   \n",
       "                              62155                              0   \n",
       "                              63400                              0   \n",
       "                              65002                              0   \n",
       "                              70464                              0   \n",
       "                              71361                              0   \n",
       "                              74372                              0   \n",
       "                              75091                              0   \n",
       "                              77367                              0   \n",
       "                              91265                              0   \n",
       "                              94961                              0   \n",
       "                              98094                              0   \n",
       "                              100893                             0   \n",
       "                              101781                             0   \n",
       "                              102806                             0   \n",
       "                              102952                             0   \n",
       "                              104476                             0   \n",
       "                              106247                             0   \n",
       "...                                                            ...   \n",
       "GGG         2014J             1950911                            0   \n",
       "                              1977701                            0   \n",
       "                              2004143                            0   \n",
       "                              2052942                            0   \n",
       "                              2053521                            0   \n",
       "                              2203216                            0   \n",
       "                              2214722                            0   \n",
       "                              2239862                            0   \n",
       "                              2268380                            0   \n",
       "                              2270562                            1   \n",
       "                              2271766                            0   \n",
       "                              2282141                            0   \n",
       "                              2311714                            0   \n",
       "                              2338614                            0   \n",
       "                              2342238                            0   \n",
       "                              2357806                            0   \n",
       "                              2373245                            0   \n",
       "                              2378591                            0   \n",
       "                              2456431                            0   \n",
       "                              2475886                            0   \n",
       "                              2508153                            0   \n",
       "                              2533195                            1   \n",
       "                              2606765                            0   \n",
       "                              2608143                            0   \n",
       "                              2620947                            0   \n",
       "                              2640965                            0   \n",
       "                              2645731                            0   \n",
       "                              2648187                            0   \n",
       "                              2679821                            1   \n",
       "                              2684003                            0   \n",
       "\n",
       "                                          region_South Region  \\\n",
       "code_module code_presentation id_student                        \n",
       "AAA         2013J             11391                         0   \n",
       "                              28400                         0   \n",
       "                              30268                         0   \n",
       "                              31604                         0   \n",
       "                              32885                         0   \n",
       "                              38053                         0   \n",
       "                              45462                         0   \n",
       "                              45642                         0   \n",
       "                              52130                         0   \n",
       "                              53025                         0   \n",
       "                              57506                         1   \n",
       "                              58873                         0   \n",
       "                              59185                         0   \n",
       "                              62155                         0   \n",
       "                              63400                         0   \n",
       "                              65002                         0   \n",
       "                              70464                         0   \n",
       "                              71361                         0   \n",
       "                              74372                         0   \n",
       "                              75091                         0   \n",
       "                              77367                         0   \n",
       "                              91265                         0   \n",
       "                              94961                         1   \n",
       "                              98094                         0   \n",
       "                              100893                        0   \n",
       "                              101781                        1   \n",
       "                              102806                        0   \n",
       "                              102952                        0   \n",
       "                              104476                        0   \n",
       "                              106247                        1   \n",
       "...                                                       ...   \n",
       "GGG         2014J             1950911                       0   \n",
       "                              1977701                       1   \n",
       "                              2004143                       0   \n",
       "                              2052942                       0   \n",
       "                              2053521                       0   \n",
       "                              2203216                       0   \n",
       "                              2214722                       0   \n",
       "                              2239862                       0   \n",
       "                              2268380                       0   \n",
       "                              2270562                       0   \n",
       "                              2271766                       0   \n",
       "                              2282141                       0   \n",
       "                              2311714                       0   \n",
       "                              2338614                       0   \n",
       "                              2342238                       0   \n",
       "                              2357806                       0   \n",
       "                              2373245                       0   \n",
       "                              2378591                       0   \n",
       "                              2456431                       1   \n",
       "                              2475886                       0   \n",
       "                              2508153                       0   \n",
       "                              2533195                       0   \n",
       "                              2606765                       0   \n",
       "                              2608143                       0   \n",
       "                              2620947                       0   \n",
       "                              2640965                       0   \n",
       "                              2645731                       0   \n",
       "                              2648187                       1   \n",
       "                              2679821                       0   \n",
       "                              2684003                       0   \n",
       "\n",
       "                                          region_South West Region  \\\n",
       "code_module code_presentation id_student                             \n",
       "AAA         2013J             11391                              0   \n",
       "                              28400                              0   \n",
       "                              30268                              0   \n",
       "                              31604                              0   \n",
       "                              32885                              0   \n",
       "                              38053                              0   \n",
       "                              45462                              0   \n",
       "                              45642                              0   \n",
       "                              52130                              0   \n",
       "                              53025                              0   \n",
       "                              57506                              0   \n",
       "                              58873                              0   \n",
       "                              59185                              0   \n",
       "                              62155                              0   \n",
       "                              63400                              0   \n",
       "                              65002                              0   \n",
       "                              70464                              0   \n",
       "                              71361                              0   \n",
       "                              74372                              0   \n",
       "                              75091                              1   \n",
       "                              77367                              0   \n",
       "                              91265                              0   \n",
       "                              94961                              0   \n",
       "                              98094                              0   \n",
       "                              100893                             0   \n",
       "                              101781                             0   \n",
       "                              102806                             0   \n",
       "                              102952                             0   \n",
       "                              104476                             0   \n",
       "                              106247                             0   \n",
       "...                                                            ...   \n",
       "GGG         2014J             1950911                            1   \n",
       "                              1977701                            0   \n",
       "                              2004143                            0   \n",
       "                              2052942                            0   \n",
       "                              2053521                            1   \n",
       "                              2203216                            0   \n",
       "                              2214722                            0   \n",
       "                              2239862                            0   \n",
       "                              2268380                            0   \n",
       "                              2270562                            0   \n",
       "                              2271766                            0   \n",
       "                              2282141                            0   \n",
       "                              2311714                            0   \n",
       "                              2338614                            0   \n",
       "                              2342238                            0   \n",
       "                              2357806                            0   \n",
       "                              2373245                            0   \n",
       "                              2378591                            0   \n",
       "                              2456431                            0   \n",
       "                              2475886                            0   \n",
       "                              2508153                            0   \n",
       "                              2533195                            0   \n",
       "                              2606765                            0   \n",
       "                              2608143                            0   \n",
       "                              2620947                            0   \n",
       "                              2640965                            0   \n",
       "                              2645731                            0   \n",
       "                              2648187                            0   \n",
       "                              2679821                            0   \n",
       "                              2684003                            0   \n",
       "\n",
       "                                          region_Wales  \\\n",
       "code_module code_presentation id_student                 \n",
       "AAA         2013J             11391                  0   \n",
       "                              28400                  0   \n",
       "                              30268                  0   \n",
       "                              31604                  0   \n",
       "                              32885                  0   \n",
       "                              38053                  1   \n",
       "                              45462                  0   \n",
       "                              45642                  0   \n",
       "                              52130                  0   \n",
       "                              53025                  0   \n",
       "                              57506                  0   \n",
       "                              58873                  0   \n",
       "                              59185                  0   \n",
       "                              62155                  0   \n",
       "                              63400                  0   \n",
       "                              65002                  0   \n",
       "                              70464                  0   \n",
       "                              71361                  0   \n",
       "                              74372                  0   \n",
       "                              75091                  0   \n",
       "                              77367                  0   \n",
       "                              91265                  0   \n",
       "                              94961                  0   \n",
       "                              98094                  1   \n",
       "                              100893                 0   \n",
       "                              101781                 0   \n",
       "                              102806                 0   \n",
       "                              102952                 0   \n",
       "                              104476                 0   \n",
       "                              106247                 0   \n",
       "...                                                ...   \n",
       "GGG         2014J             1950911                0   \n",
       "                              1977701                0   \n",
       "                              2004143                0   \n",
       "                              2052942                0   \n",
       "                              2053521                0   \n",
       "                              2203216                1   \n",
       "                              2214722                0   \n",
       "                              2239862                0   \n",
       "                              2268380                0   \n",
       "                              2270562                0   \n",
       "                              2271766                0   \n",
       "                              2282141                1   \n",
       "                              2311714                0   \n",
       "                              2338614                0   \n",
       "                              2342238                0   \n",
       "                              2357806                0   \n",
       "                              2373245                0   \n",
       "                              2378591                0   \n",
       "                              2456431                0   \n",
       "                              2475886                0   \n",
       "                              2508153                0   \n",
       "                              2533195                0   \n",
       "                              2606765                0   \n",
       "                              2608143                0   \n",
       "                              2620947                0   \n",
       "                              2640965                1   \n",
       "                              2645731                0   \n",
       "                              2648187                0   \n",
       "                              2679821                0   \n",
       "                              2684003                0   \n",
       "\n",
       "                                          region_West Midlands Region  \\\n",
       "code_module code_presentation id_student                                \n",
       "AAA         2013J             11391                                 0   \n",
       "                              28400                                 0   \n",
       "                              30268                                 0   \n",
       "                              31604                                 0   \n",
       "                              32885                                 1   \n",
       "                              38053                                 0   \n",
       "                              45462                                 0   \n",
       "                              45642                                 0   \n",
       "                              52130                                 0   \n",
       "                              53025                                 0   \n",
       "                              57506                                 0   \n",
       "                              58873                                 0   \n",
       "                              59185                                 0   \n",
       "                              62155                                 0   \n",
       "                              63400                                 0   \n",
       "                              65002                                 0   \n",
       "                              70464                                 1   \n",
       "                              71361                                 0   \n",
       "                              74372                                 0   \n",
       "                              75091                                 0   \n",
       "                              77367                                 0   \n",
       "                              91265                                 0   \n",
       "                              94961                                 0   \n",
       "                              98094                                 0   \n",
       "                              100893                                0   \n",
       "                              101781                                0   \n",
       "                              102806                                0   \n",
       "                              102952                                0   \n",
       "                              104476                                0   \n",
       "                              106247                                0   \n",
       "...                                                               ...   \n",
       "GGG         2014J             1950911                               0   \n",
       "                              1977701                               0   \n",
       "                              2004143                               0   \n",
       "                              2052942                               0   \n",
       "                              2053521                               0   \n",
       "                              2203216                               0   \n",
       "                              2214722                               0   \n",
       "                              2239862                               0   \n",
       "                              2268380                               0   \n",
       "                              2270562                               0   \n",
       "                              2271766                               0   \n",
       "                              2282141                               0   \n",
       "                              2311714                               0   \n",
       "                              2338614                               0   \n",
       "                              2342238                               0   \n",
       "                              2357806                               0   \n",
       "                              2373245                               0   \n",
       "                              2378591                               1   \n",
       "                              2456431                               0   \n",
       "                              2475886                               0   \n",
       "                              2508153                               0   \n",
       "                              2533195                               0   \n",
       "                              2606765                               0   \n",
       "                              2608143                               0   \n",
       "                              2620947                               0   \n",
       "                              2640965                               0   \n",
       "                              2645731                               0   \n",
       "                              2648187                               0   \n",
       "                              2679821                               0   \n",
       "                              2684003                               0   \n",
       "\n",
       "                                          region_Yorkshire Region final_result  \n",
       "code_module code_presentation id_student                                        \n",
       "AAA         2013J             11391                             0         Pass  \n",
       "                              28400                             0         Pass  \n",
       "                              30268                             0    Withdrawn  \n",
       "                              31604                             0         Pass  \n",
       "                              32885                             0         Pass  \n",
       "                              38053                             0         Pass  \n",
       "                              45462                             0         Pass  \n",
       "                              45642                             0         Pass  \n",
       "                              52130                             0         Pass  \n",
       "                              53025                             0         Pass  \n",
       "                              57506                             0         Pass  \n",
       "                              58873                             0         Pass  \n",
       "                              59185                             0         Pass  \n",
       "                              62155                             0         Pass  \n",
       "                              63400                             0         Pass  \n",
       "                              65002                             0    Withdrawn  \n",
       "                              70464                             0         Pass  \n",
       "                              71361                             0         Pass  \n",
       "                              74372                             0         Fail  \n",
       "                              75091                             0         Pass  \n",
       "                              77367                             0         Pass  \n",
       "                              91265                             0         Pass  \n",
       "                              94961                             0    Withdrawn  \n",
       "                              98094                             0         Pass  \n",
       "                              100893                            1         Pass  \n",
       "                              101781                            0         Pass  \n",
       "                              102806                            0         Pass  \n",
       "                              102952                            0         Pass  \n",
       "                              104476                            0         Pass  \n",
       "                              106247                            0    Withdrawn  \n",
       "...                                                           ...          ...  \n",
       "GGG         2014J             1950911                           0         Pass  \n",
       "                              1977701                           0         Pass  \n",
       "                              2004143                           0         Pass  \n",
       "                              2052942                           0         Pass  \n",
       "                              2053521                           0         Pass  \n",
       "                              2203216                           0    Withdrawn  \n",
       "                              2214722                           0    Withdrawn  \n",
       "                              2239862                           0    Withdrawn  \n",
       "                              2268380                           0         Pass  \n",
       "                              2270562                           0         Pass  \n",
       "                              2271766                           0         Pass  \n",
       "                              2282141                           0    Withdrawn  \n",
       "                              2311714                           0         Pass  \n",
       "                              2338614                           0    Withdrawn  \n",
       "                              2342238                           0    Withdrawn  \n",
       "                              2357806                           0    Withdrawn  \n",
       "                              2373245                           0         Pass  \n",
       "                              2378591                           0         Fail  \n",
       "                              2456431                           0         Fail  \n",
       "                              2475886                           0         Fail  \n",
       "                              2508153                           0         Pass  \n",
       "                              2533195                           0         Pass  \n",
       "                              2606765                           0         Pass  \n",
       "                              2608143                           0    Withdrawn  \n",
       "                              2620947                           0         Pass  \n",
       "                              2640965                           0         Fail  \n",
       "                              2645731                           0         Pass  \n",
       "                              2648187                           0         Pass  \n",
       "                              2679821                           0    Withdrawn  \n",
       "                              2684003                           1         Pass  \n",
       "\n",
       "[32593 rows x 18 columns]"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# set index\n",
    "student_info_feature.set_index(['code_module','code_presentation','id_student'],inplace=True)\n",
    "student_info_feature"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Student Registration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>date_unregistration</th>\n",
       "      <th>Last Minite</th>\n",
       "      <th>Late Reg</th>\n",
       "      <th>Regular Reg</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">AAA</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2013J</th>\n",
       "      <th>11391</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28400</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30268</th>\n",
       "      <td>12.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31604</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32885</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38053</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45462</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45642</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52130</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53025</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57506</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58873</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59185</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62155</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63400</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65002</th>\n",
       "      <td>96.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70464</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71361</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74372</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75091</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77367</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91265</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94961</th>\n",
       "      <td>72.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98094</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100893</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101781</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102806</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102952</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104476</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106247</th>\n",
       "      <td>175.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">GGG</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2014J</th>\n",
       "      <th>1950911</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1977701</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2004143</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2052942</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2053521</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2203216</th>\n",
       "      <td>125.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2214722</th>\n",
       "      <td>206.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2239862</th>\n",
       "      <td>-43.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2268380</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2270562</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2271766</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2282141</th>\n",
       "      <td>62.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2311714</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2338614</th>\n",
       "      <td>58.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2342238</th>\n",
       "      <td>74.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2357806</th>\n",
       "      <td>73.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2373245</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2378591</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2456431</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2475886</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2508153</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2533195</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2606765</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608143</th>\n",
       "      <td>48.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2620947</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2640965</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2645731</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2648187</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2679821</th>\n",
       "      <td>101.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2684003</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32593 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          date_unregistration  Last Minite  \\\n",
       "code_module code_presentation id_student                                     \n",
       "AAA         2013J             11391                       NaN            0   \n",
       "                              28400                       NaN            0   \n",
       "                              30268                      12.0            0   \n",
       "                              31604                       NaN            0   \n",
       "                              32885                       NaN            0   \n",
       "                              38053                       NaN            0   \n",
       "                              45462                       NaN            0   \n",
       "                              45642                       NaN            0   \n",
       "                              52130                       NaN            0   \n",
       "                              53025                       NaN            0   \n",
       "                              57506                       NaN            0   \n",
       "                              58873                       NaN            0   \n",
       "                              59185                       NaN            0   \n",
       "                              62155                       NaN            0   \n",
       "                              63400                       NaN            0   \n",
       "                              65002                      96.0            0   \n",
       "                              70464                       NaN            0   \n",
       "                              71361                       NaN            0   \n",
       "                              74372                       NaN            0   \n",
       "                              75091                       NaN            0   \n",
       "                              77367                       NaN            0   \n",
       "                              91265                       NaN            0   \n",
       "                              94961                      72.0            0   \n",
       "                              98094                       NaN            0   \n",
       "                              100893                      NaN            0   \n",
       "                              101781                      NaN            0   \n",
       "                              102806                      NaN            0   \n",
       "                              102952                      NaN            0   \n",
       "                              104476                      NaN            0   \n",
       "                              106247                    175.0            0   \n",
       "...                                                       ...          ...   \n",
       "GGG         2014J             1950911                     NaN            0   \n",
       "                              1977701                     NaN            0   \n",
       "                              2004143                     NaN            0   \n",
       "                              2052942                     NaN            0   \n",
       "                              2053521                     NaN            0   \n",
       "                              2203216                   125.0            0   \n",
       "                              2214722                   206.0            0   \n",
       "                              2239862                   -43.0            0   \n",
       "                              2268380                     NaN            0   \n",
       "                              2270562                     NaN            0   \n",
       "                              2271766                     NaN            0   \n",
       "                              2282141                    62.0            0   \n",
       "                              2311714                     NaN            0   \n",
       "                              2338614                    58.0            0   \n",
       "                              2342238                    74.0            0   \n",
       "                              2357806                    73.0            0   \n",
       "                              2373245                     NaN            0   \n",
       "                              2378591                     NaN            0   \n",
       "                              2456431                     NaN            0   \n",
       "                              2475886                     NaN            0   \n",
       "                              2508153                     NaN            0   \n",
       "                              2533195                     NaN            0   \n",
       "                              2606765                     NaN            0   \n",
       "                              2608143                    48.0            0   \n",
       "                              2620947                     NaN            0   \n",
       "                              2640965                     NaN            0   \n",
       "                              2645731                     NaN            0   \n",
       "                              2648187                     NaN            0   \n",
       "                              2679821                   101.0            0   \n",
       "                              2684003                     NaN            0   \n",
       "\n",
       "                                          Late Reg  Regular Reg  \n",
       "code_module code_presentation id_student                         \n",
       "AAA         2013J             11391              0            0  \n",
       "                              28400              0            0  \n",
       "                              30268              0            0  \n",
       "                              31604              0            0  \n",
       "                              32885              0            0  \n",
       "                              38053              0            0  \n",
       "                              45462              0            0  \n",
       "                              45642              0            1  \n",
       "                              52130              0            0  \n",
       "                              53025              0            0  \n",
       "                              57506              0            0  \n",
       "                              58873              0            0  \n",
       "                              59185              0            0  \n",
       "                              62155              0            0  \n",
       "                              63400              0            0  \n",
       "                              65002              0            0  \n",
       "                              70464              0            0  \n",
       "                              71361              0            0  \n",
       "                              74372              0            0  \n",
       "                              75091              0            0  \n",
       "                              77367              0            1  \n",
       "                              91265              0            0  \n",
       "                              94961              0            0  \n",
       "                              98094              0            0  \n",
       "                              100893             0            0  \n",
       "                              101781             0            0  \n",
       "                              102806             0            0  \n",
       "                              102952             0            0  \n",
       "                              104476             0            0  \n",
       "                              106247             0            1  \n",
       "...                                            ...          ...  \n",
       "GGG         2014J             1950911            0            1  \n",
       "                              1977701            0            0  \n",
       "                              2004143            0            0  \n",
       "                              2052942            0            1  \n",
       "                              2053521            0            0  \n",
       "                              2203216            0            1  \n",
       "                              2214722            0            1  \n",
       "                              2239862            0            0  \n",
       "                              2268380            0            0  \n",
       "                              2270562            0            1  \n",
       "                              2271766            0            1  \n",
       "                              2282141            0            0  \n",
       "                              2311714            0            0  \n",
       "                              2338614            0            1  \n",
       "                              2342238            0            0  \n",
       "                              2357806            0            0  \n",
       "                              2373245            0            0  \n",
       "                              2378591            0            0  \n",
       "                              2456431            0            0  \n",
       "                              2475886            0            0  \n",
       "                              2508153            0            0  \n",
       "                              2533195            0            0  \n",
       "                              2606765            0            0  \n",
       "                              2608143            0            0  \n",
       "                              2620947            0            1  \n",
       "                              2640965            0            1  \n",
       "                              2645731            0            1  \n",
       "                              2648187            0            0  \n",
       "                              2679821            0            0  \n",
       "                              2684003            0            1  \n",
       "\n",
       "[32593 rows x 4 columns]"
      ]
     },
     "execution_count": 126,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# feature df\n",
    "student_reg_feature = student_reg.copy()\n",
    "\n",
    "# registration date - early bird/regular reg/late reg/last minute\n",
    "student_reg_feature = pd.merge(student_reg_feature,course_basic,how='left',\n",
    "                               on=['code_module','code_presentation'])\n",
    "\n",
    "# student registration - fill missing value\n",
    "student_reg_feature['date_registration'].fillna(method='ffill',inplace=True)\n",
    "# student registration - categorical\n",
    "student_reg_feature['date_registration'] = pd.Series(np.where(student_reg_feature['date_registration']<=-30,'Early Bird',\n",
    "         np.where(student_reg_feature['date_registration']<=0.2*student_reg_feature['module_presentation_length'],'Regular Reg',\n",
    "             np.where(student_reg_feature['date_registration']<=0.5*student_reg_feature['module_presentation_length'],'Late Reg',\n",
    "                'Last Minite'))))\n",
    "# OHE student registration\n",
    "student_reg_feature = pd.concat([student_reg_feature,pd.get_dummies(student_reg_feature['date_registration'],\n",
    "                                  drop_first=True)],axis=1)\n",
    "\n",
    "# drop module_presentation_length,date_registration\n",
    "student_reg_feature.drop(['module_presentation_length','date_registration'],axis=1,inplace=True)\n",
    "\n",
    "# set index\n",
    "student_reg_feature.set_index(['code_module','code_presentation','id_student'],inplace=True)\n",
    "student_reg_feature"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Student VLE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>id_site</th>\n",
       "      <th>sum_click</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">AAA</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2013J</th>\n",
       "      <th>11391</th>\n",
       "      <td>107152743</td>\n",
       "      <td>934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28400</th>\n",
       "      <td>235082915</td>\n",
       "      <td>1435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30268</th>\n",
       "      <td>41550803</td>\n",
       "      <td>281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31604</th>\n",
       "      <td>362470398</td>\n",
       "      <td>2158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32885</th>\n",
       "      <td>192445868</td>\n",
       "      <td>1034</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38053</th>\n",
       "      <td>395256463</td>\n",
       "      <td>2445</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45462</th>\n",
       "      <td>194082992</td>\n",
       "      <td>1492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45642</th>\n",
       "      <td>290304037</td>\n",
       "      <td>1428</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52130</th>\n",
       "      <td>324210061</td>\n",
       "      <td>1894</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53025</th>\n",
       "      <td>494203477</td>\n",
       "      <td>3158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57506</th>\n",
       "      <td>220336174</td>\n",
       "      <td>1319</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58873</th>\n",
       "      <td>287574157</td>\n",
       "      <td>1732</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59185</th>\n",
       "      <td>188617767</td>\n",
       "      <td>1102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62155</th>\n",
       "      <td>536297007</td>\n",
       "      <td>3388</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63400</th>\n",
       "      <td>415504907</td>\n",
       "      <td>2737</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65002</th>\n",
       "      <td>29523092</td>\n",
       "      <td>171</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70464</th>\n",
       "      <td>112076634</td>\n",
       "      <td>1053</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71361</th>\n",
       "      <td>398011759</td>\n",
       "      <td>2327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74372</th>\n",
       "      <td>39363366</td>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75091</th>\n",
       "      <td>412220476</td>\n",
       "      <td>2992</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77367</th>\n",
       "      <td>148159967</td>\n",
       "      <td>680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91265</th>\n",
       "      <td>271174087</td>\n",
       "      <td>1494</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94961</th>\n",
       "      <td>55767176</td>\n",
       "      <td>339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98094</th>\n",
       "      <td>211033335</td>\n",
       "      <td>2839</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100893</th>\n",
       "      <td>132854169</td>\n",
       "      <td>744</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101781</th>\n",
       "      <td>499157996</td>\n",
       "      <td>4104</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102806</th>\n",
       "      <td>426961981</td>\n",
       "      <td>1944</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102952</th>\n",
       "      <td>171123469</td>\n",
       "      <td>1150</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104476</th>\n",
       "      <td>542360146</td>\n",
       "      <td>4777</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106247</th>\n",
       "      <td>79276514</td>\n",
       "      <td>465</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">GGG</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2014J</th>\n",
       "      <th>1931810</th>\n",
       "      <td>229632177</td>\n",
       "      <td>727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950911</th>\n",
       "      <td>243987761</td>\n",
       "      <td>986</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1977701</th>\n",
       "      <td>170429473</td>\n",
       "      <td>545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2004143</th>\n",
       "      <td>99565434</td>\n",
       "      <td>382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2052942</th>\n",
       "      <td>59201759</td>\n",
       "      <td>200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2053521</th>\n",
       "      <td>304074170</td>\n",
       "      <td>1056</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2203216</th>\n",
       "      <td>69968349</td>\n",
       "      <td>232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2214722</th>\n",
       "      <td>51127675</td>\n",
       "      <td>410</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2268380</th>\n",
       "      <td>142619537</td>\n",
       "      <td>663</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2270562</th>\n",
       "      <td>621595573</td>\n",
       "      <td>1926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2271766</th>\n",
       "      <td>83418809</td>\n",
       "      <td>288</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2282141</th>\n",
       "      <td>65481317</td>\n",
       "      <td>208</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2311714</th>\n",
       "      <td>357003125</td>\n",
       "      <td>1339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2338614</th>\n",
       "      <td>17043618</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2342238</th>\n",
       "      <td>22425562</td>\n",
       "      <td>118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2357806</th>\n",
       "      <td>10763699</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2373245</th>\n",
       "      <td>174019576</td>\n",
       "      <td>565</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2378591</th>\n",
       "      <td>67272814</td>\n",
       "      <td>230</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2456431</th>\n",
       "      <td>611742409</td>\n",
       "      <td>2151</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2475886</th>\n",
       "      <td>7176174</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2508153</th>\n",
       "      <td>202720682</td>\n",
       "      <td>598</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2533195</th>\n",
       "      <td>183882436</td>\n",
       "      <td>755</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2606765</th>\n",
       "      <td>71759707</td>\n",
       "      <td>236</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608143</th>\n",
       "      <td>16146199</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2620947</th>\n",
       "      <td>162354782</td>\n",
       "      <td>476</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2640965</th>\n",
       "      <td>17043811</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2645731</th>\n",
       "      <td>212591497</td>\n",
       "      <td>893</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2648187</th>\n",
       "      <td>96875459</td>\n",
       "      <td>312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2679821</th>\n",
       "      <td>54716352</td>\n",
       "      <td>275</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2684003</th>\n",
       "      <td>162353469</td>\n",
       "      <td>616</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>29228 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                            id_site  sum_click\n",
       "code_module code_presentation id_student                      \n",
       "AAA         2013J             11391       107152743        934\n",
       "                              28400       235082915       1435\n",
       "                              30268        41550803        281\n",
       "                              31604       362470398       2158\n",
       "                              32885       192445868       1034\n",
       "                              38053       395256463       2445\n",
       "                              45462       194082992       1492\n",
       "                              45642       290304037       1428\n",
       "                              52130       324210061       1894\n",
       "                              53025       494203477       3158\n",
       "                              57506       220336174       1319\n",
       "                              58873       287574157       1732\n",
       "                              59185       188617767       1102\n",
       "                              62155       536297007       3388\n",
       "                              63400       415504907       2737\n",
       "                              65002        29523092        171\n",
       "                              70464       112076634       1053\n",
       "                              71361       398011759       2327\n",
       "                              74372        39363366        116\n",
       "                              75091       412220476       2992\n",
       "                              77367       148159967        680\n",
       "                              91265       271174087       1494\n",
       "                              94961        55767176        339\n",
       "                              98094       211033335       2839\n",
       "                              100893      132854169        744\n",
       "                              101781      499157996       4104\n",
       "                              102806      426961981       1944\n",
       "                              102952      171123469       1150\n",
       "                              104476      542360146       4777\n",
       "                              106247       79276514        465\n",
       "...                                             ...        ...\n",
       "GGG         2014J             1931810     229632177        727\n",
       "                              1950911     243987761        986\n",
       "                              1977701     170429473        545\n",
       "                              2004143      99565434        382\n",
       "                              2052942      59201759        200\n",
       "                              2053521     304074170       1056\n",
       "                              2203216      69968349        232\n",
       "                              2214722      51127675        410\n",
       "                              2268380     142619537        663\n",
       "                              2270562     621595573       1926\n",
       "                              2271766      83418809        288\n",
       "                              2282141      65481317        208\n",
       "                              2311714     357003125       1339\n",
       "                              2338614      17043618         51\n",
       "                              2342238      22425562        118\n",
       "                              2357806      10763699         58\n",
       "                              2373245     174019576        565\n",
       "                              2378591      67272814        230\n",
       "                              2456431     611742409       2151\n",
       "                              2475886       7176174          9\n",
       "                              2508153     202720682        598\n",
       "                              2533195     183882436        755\n",
       "                              2606765      71759707        236\n",
       "                              2608143      16146199         37\n",
       "                              2620947     162354782        476\n",
       "                              2640965      17043811         41\n",
       "                              2645731     212591497        893\n",
       "                              2648187      96875459        312\n",
       "                              2679821      54716352        275\n",
       "                              2684003     162353469        616\n",
       "\n",
       "[29228 rows x 2 columns]"
      ]
     },
     "execution_count": 167,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# group VLE data by student\n",
    "studentVle_new  = student_vle.groupby([\"code_module\",\"code_presentation\",\"id_student\",\"date\"]).agg('sum')\n",
    "vle = studentVle_new.groupby([\"code_module\",\"code_presentation\",\"id_student\"]).agg('sum')\n",
    "vle"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {},
   "outputs": [],
   "source": [
    "# generate row index vector\n",
    "indexs = []\n",
    "for i in studentVle_new.index:\n",
    "    index = i[:3]\n",
    "    indexs.append(index)\n",
    "\n",
    "# student VLE information dictionary\n",
    "info = {}\n",
    "for i in set(indexs):\n",
    "    # total number of clicks\n",
    "    click_info = studentVle_new.loc[i].describe()[\"sum_click\"]\n",
    "    # first learning date, last learning date\n",
    "    max_date = studentVle_new.loc[i].index[-1]\n",
    "    min_date = studentVle_new.loc[i].index[0]\n",
    "    # std of clicks every time of study\n",
    "    std = click_info[\"std\"]\n",
    "    if np.isnan(std):\n",
    "        std = 0\n",
    "    # average click per time of study, std of clicks every time of study, start learning date, end learning date\n",
    "    info[i]=[[click_info[\"mean\"],std,click_info[\"count\"],max_date,min_date]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# k-means clustering based on student learning behavior\n",
    "l = []\n",
    "for i in info.values():\n",
    "    l.append(i[0])\n",
    "X = np.array(l)\n",
    "norm_X = preprocessing.scale(X)\n",
    "kmeans = KMeans(n_clusters=4, random_state=0).fit(norm_X)\n",
    "kmeans.cluster_centers_\n",
    "label = kmeans.labels_\n",
    "vle[\"learning_pattern\"] = label"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>sum_click</th>\n",
       "      <th>learning_pattern</th>\n",
       "      <th>learning_pattern_1</th>\n",
       "      <th>learning_pattern_2</th>\n",
       "      <th>learning_pattern_3</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>code_module</th>\n",
       "      <th>code_presentation</th>\n",
       "      <th>id_student</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">AAA</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2013J</th>\n",
       "      <th>11391</th>\n",
       "      <td>934</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28400</th>\n",
       "      <td>1435</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30268</th>\n",
       "      <td>281</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31604</th>\n",
       "      <td>2158</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32885</th>\n",
       "      <td>1034</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38053</th>\n",
       "      <td>2445</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45462</th>\n",
       "      <td>1492</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45642</th>\n",
       "      <td>1428</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52130</th>\n",
       "      <td>1894</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53025</th>\n",
       "      <td>3158</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57506</th>\n",
       "      <td>1319</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58873</th>\n",
       "      <td>1732</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59185</th>\n",
       "      <td>1102</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62155</th>\n",
       "      <td>3388</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63400</th>\n",
       "      <td>2737</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65002</th>\n",
       "      <td>171</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70464</th>\n",
       "      <td>1053</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71361</th>\n",
       "      <td>2327</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74372</th>\n",
       "      <td>116</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75091</th>\n",
       "      <td>2992</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77367</th>\n",
       "      <td>680</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91265</th>\n",
       "      <td>1494</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94961</th>\n",
       "      <td>339</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98094</th>\n",
       "      <td>2839</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100893</th>\n",
       "      <td>744</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>101781</th>\n",
       "      <td>4104</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102806</th>\n",
       "      <td>1944</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102952</th>\n",
       "      <td>1150</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104476</th>\n",
       "      <td>4777</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106247</th>\n",
       "      <td>465</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">GGG</th>\n",
       "      <th rowspan=\"30\" valign=\"top\">2014J</th>\n",
       "      <th>1931810</th>\n",
       "      <td>727</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950911</th>\n",
       "      <td>986</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1977701</th>\n",
       "      <td>545</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2004143</th>\n",
       "      <td>382</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2052942</th>\n",
       "      <td>200</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2053521</th>\n",
       "      <td>1056</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2203216</th>\n",
       "      <td>232</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2214722</th>\n",
       "      <td>410</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2268380</th>\n",
       "      <td>663</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2270562</th>\n",
       "      <td>1926</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2271766</th>\n",
       "      <td>288</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2282141</th>\n",
       "      <td>208</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2311714</th>\n",
       "      <td>1339</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2338614</th>\n",
       "      <td>51</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2342238</th>\n",
       "      <td>118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2357806</th>\n",
       "      <td>58</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2373245</th>\n",
       "      <td>565</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2378591</th>\n",
       "      <td>230</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2456431</th>\n",
       "      <td>2151</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2475886</th>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2508153</th>\n",
       "      <td>598</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2533195</th>\n",
       "      <td>755</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2606765</th>\n",
       "      <td>236</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608143</th>\n",
       "      <td>37</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2620947</th>\n",
       "      <td>476</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2640965</th>\n",
       "      <td>41</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2645731</th>\n",
       "      <td>893</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2648187</th>\n",
       "      <td>312</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2679821</th>\n",
       "      <td>275</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2684003</th>\n",
       "      <td>616</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>29228 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          sum_click  learning_pattern  \\\n",
       "code_module code_presentation id_student                                \n",
       "AAA         2013J             11391             934                 0   \n",
       "                              28400            1435                 3   \n",
       "                              30268             281                 1   \n",
       "                              31604            2158                 0   \n",
       "                              32885            1034                 3   \n",
       "                              38053            2445                 3   \n",
       "                              45462            1492                 2   \n",
       "                              45642            1428                 3   \n",
       "                              52130            1894                 3   \n",
       "                              53025            3158                 3   \n",
       "                              57506            1319                 0   \n",
       "                              58873            1732                 0   \n",
       "                              59185            1102                 3   \n",
       "                              62155            3388                 2   \n",
       "                              63400            2737                 3   \n",
       "                              65002             171                 2   \n",
       "                              70464            1053                 1   \n",
       "                              71361            2327                 2   \n",
       "                              74372             116                 2   \n",
       "                              75091            2992                 1   \n",
       "                              77367             680                 3   \n",
       "                              91265            1494                 0   \n",
       "                              94961             339                 0   \n",
       "                              98094            2839                 0   \n",
       "                              100893            744                 3   \n",
       "                              101781           4104                 2   \n",
       "                              102806           1944                 0   \n",
       "                              102952           1150                 2   \n",
       "                              104476           4777                 3   \n",
       "                              106247            465                 3   \n",
       "...                                             ...               ...   \n",
       "GGG         2014J             1931810           727                 3   \n",
       "                              1950911           986                 3   \n",
       "                              1977701           545                 3   \n",
       "                              2004143           382                 3   \n",
       "                              2052942           200                 3   \n",
       "                              2053521          1056                 3   \n",
       "                              2203216           232                 1   \n",
       "                              2214722           410                 3   \n",
       "                              2268380           663                 3   \n",
       "                              2270562          1926                 1   \n",
       "                              2271766           288                 1   \n",
       "                              2282141           208                 3   \n",
       "                              2311714          1339                 1   \n",
       "                              2338614            51                 0   \n",
       "                              2342238           118                 0   \n",
       "                              2357806            58                 0   \n",
       "                              2373245           565                 3   \n",
       "                              2378591           230                 3   \n",
       "                              2456431          2151                 3   \n",
       "                              2475886             9                 1   \n",
       "                              2508153           598                 1   \n",
       "                              2533195           755                 1   \n",
       "                              2606765           236                 3   \n",
       "                              2608143            37                 3   \n",
       "                              2620947           476                 0   \n",
       "                              2640965            41                 1   \n",
       "                              2645731           893                 3   \n",
       "                              2648187           312                 0   \n",
       "                              2679821           275                 1   \n",
       "                              2684003           616                 0   \n",
       "\n",
       "                                          learning_pattern_1  \\\n",
       "code_module code_presentation id_student                       \n",
       "AAA         2013J             11391                        0   \n",
       "                              28400                        0   \n",
       "                              30268                        1   \n",
       "                              31604                        0   \n",
       "                              32885                        0   \n",
       "                              38053                        0   \n",
       "                              45462                        0   \n",
       "                              45642                        0   \n",
       "                              52130                        0   \n",
       "                              53025                        0   \n",
       "                              57506                        0   \n",
       "                              58873                        0   \n",
       "                              59185                        0   \n",
       "                              62155                        0   \n",
       "                              63400                        0   \n",
       "                              65002                        0   \n",
       "                              70464                        1   \n",
       "                              71361                        0   \n",
       "                              74372                        0   \n",
       "                              75091                        1   \n",
       "                              77367                        0   \n",
       "                              91265                        0   \n",
       "                              94961                        0   \n",
       "                              98094                        0   \n",
       "                              100893                       0   \n",
       "                              101781                       0   \n",
       "                              102806                       0   \n",
       "                              102952                       0   \n",
       "                              104476                       0   \n",
       "                              106247                       0   \n",
       "...                                                      ...   \n",
       "GGG         2014J             1931810                      0   \n",
       "                              1950911                      0   \n",
       "                              1977701                      0   \n",
       "                              2004143                      0   \n",
       "                              2052942                      0   \n",
       "                              2053521                      0   \n",
       "                              2203216                      1   \n",
       "                              2214722                      0   \n",
       "                              2268380                      0   \n",
       "                              2270562                      1   \n",
       "                              2271766                      1   \n",
       "                              2282141                      0   \n",
       "                              2311714                      1   \n",
       "                              2338614                      0   \n",
       "                              2342238                      0   \n",
       "                              2357806                      0   \n",
       "                              2373245                      0   \n",
       "                              2378591                      0   \n",
       "                              2456431                      0   \n",
       "                              2475886                      1   \n",
       "                              2508153                      1   \n",
       "                              2533195                      1   \n",
       "                              2606765                      0   \n",
       "                              2608143                      0   \n",
       "                              2620947                      0   \n",
       "                              2640965                      1   \n",
       "                              2645731                      0   \n",
       "                              2648187                      0   \n",
       "                              2679821                      1   \n",
       "                              2684003                      0   \n",
       "\n",
       "                                          learning_pattern_2  \\\n",
       "code_module code_presentation id_student                       \n",
       "AAA         2013J             11391                        0   \n",
       "                              28400                        0   \n",
       "                              30268                        0   \n",
       "                              31604                        0   \n",
       "                              32885                        0   \n",
       "                              38053                        0   \n",
       "                              45462                        1   \n",
       "                              45642                        0   \n",
       "                              52130                        0   \n",
       "                              53025                        0   \n",
       "                              57506                        0   \n",
       "                              58873                        0   \n",
       "                              59185                        0   \n",
       "                              62155                        1   \n",
       "                              63400                        0   \n",
       "                              65002                        1   \n",
       "                              70464                        0   \n",
       "                              71361                        1   \n",
       "                              74372                        1   \n",
       "                              75091                        0   \n",
       "                              77367                        0   \n",
       "                              91265                        0   \n",
       "                              94961                        0   \n",
       "                              98094                        0   \n",
       "                              100893                       0   \n",
       "                              101781                       1   \n",
       "                              102806                       0   \n",
       "                              102952                       1   \n",
       "                              104476                       0   \n",
       "                              106247                       0   \n",
       "...                                                      ...   \n",
       "GGG         2014J             1931810                      0   \n",
       "                              1950911                      0   \n",
       "                              1977701                      0   \n",
       "                              2004143                      0   \n",
       "                              2052942                      0   \n",
       "                              2053521                      0   \n",
       "                              2203216                      0   \n",
       "                              2214722                      0   \n",
       "                              2268380                      0   \n",
       "                              2270562                      0   \n",
       "                              2271766                      0   \n",
       "                              2282141                      0   \n",
       "                              2311714                      0   \n",
       "                              2338614                      0   \n",
       "                              2342238                      0   \n",
       "                              2357806                      0   \n",
       "                              2373245                      0   \n",
       "                              2378591                      0   \n",
       "                              2456431                      0   \n",
       "                              2475886                      0   \n",
       "                              2508153                      0   \n",
       "                              2533195                      0   \n",
       "                              2606765                      0   \n",
       "                              2608143                      0   \n",
       "                              2620947                      0   \n",
       "                              2640965                      0   \n",
       "                              2645731                      0   \n",
       "                              2648187                      0   \n",
       "                              2679821                      0   \n",
       "                              2684003                      0   \n",
       "\n",
       "                                          learning_pattern_3  \n",
       "code_module code_presentation id_student                      \n",
       "AAA         2013J             11391                        0  \n",
       "                              28400                        1  \n",
       "                              30268                        0  \n",
       "                              31604                        0  \n",
       "                              32885                        1  \n",
       "                              38053                        1  \n",
       "                              45462                        0  \n",
       "                              45642                        1  \n",
       "                              52130                        1  \n",
       "                              53025                        1  \n",
       "                              57506                        0  \n",
       "                              58873                        0  \n",
       "                              59185                        1  \n",
       "                              62155                        0  \n",
       "                              63400                        1  \n",
       "                              65002                        0  \n",
       "                              70464                        0  \n",
       "                              71361                        0  \n",
       "                              74372                        0  \n",
       "                              75091                        0  \n",
       "                              77367                        1  \n",
       "                              91265                        0  \n",
       "                              94961                        0  \n",
       "                              98094                        0  \n",
       "                              100893                       1  \n",
       "                              101781                       0  \n",
       "                              102806                       0  \n",
       "                              102952                       0  \n",
       "                              104476                       1  \n",
       "                              106247                       1  \n",
       "...                                                      ...  \n",
       "GGG         2014J             1931810                      1  \n",
       "                              1950911                      1  \n",
       "                              1977701                      1  \n",
       "                              2004143                      1  \n",
       "                              2052942                      1  \n",
       "                              2053521                      1  \n",
       "                              2203216                      0  \n",
       "                              2214722                      1  \n",
       "                              2268380                      1  \n",
       "                              2270562                      0  \n",
       "                              2271766                      0  \n",
       "                              2282141                      1  \n",
       "                              2311714                      0  \n",
       "                              2338614                      0  \n",
       "                              2342238                      0  \n",
       "                              2357806                      0  \n",
       "                              2373245                      1  \n",
       "                              2378591                      1  \n",
       "                              2456431                      1  \n",
       "                              2475886                      0  \n",
       "                              2508153                      0  \n",
       "                              2533195                      0  \n",
       "                              2606765                      1  \n",
       "                              2608143                      1  \n",
       "                              2620947                      0  \n",
       "                              2640965                      0  \n",
       "                              2645731                      1  \n",
       "                              2648187                      0  \n",
       "                              2679821                      0  \n",
       "                              2684003                      0  \n",
       "\n",
       "[29228 rows x 5 columns]"
      ]
     },
     "execution_count": 188,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# OHE learning pattern\n",
    "vle_feature = pd.concat([vle,pd.get_dummies(vle['learning_pattern'],\n",
    "                            prefix='learning_pattern',drop_first=True)],axis=1)\n",
    "# drop site_id\n",
    "vle_feature.drop('id_site',axis=1,inplace=True)\n",
    "vle_feature"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Student assessment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 282,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:6: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  \n"
     ]
    }
   ],
   "source": [
    "#Fill the blank final exam date in course_assess with the length of module in course_basic\n",
    "for code_module,code_presentation in zip(course_basic[\"code_module\"],course_basic[\"code_presentation\"]):\n",
    "    exam_date = course_basic[\"module_presentation_length\"][(course_basic[\"code_module\"]==code_module)&(course_basic[\"code_presentation\"]==code_presentation)]\n",
    "    origin_exam_date = course_assess[\"date\"][(course_assess[\"code_module\"]==code_module)&(course_assess[\"code_presentation\"]==code_presentation)&(course_assess[\"assessment_type\"]==\"Exam\")]\n",
    "    if np.isnan(origin_exam_date).any():\n",
    "        course_assess[\"date\"][(course_assess[\"code_module\"]==code_module)&(course_assess[\"code_presentation\"]==code_presentation)&(course_assess[\"assessment_type\"]==\"Exam\")] = int(exam_date) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 283,
   "metadata": {},
   "outputs": [],
   "source": [
    "student_assess_merge = pd.merge(student_assess,course_assess, how=\"left\",on=[\"id_assessment\"])\n",
    "student_assess_merge = pd.merge(student_assess_merge,pd.DataFrame(student_info_feature[\"final_result\"]),\n",
    "                                how=\"left\",on=[\"code_module\",\"code_presentation\",\"id_student\"])\n",
    "student_assess_merge[\"sub_diff\"] = student_assess_merge[\"date_submitted\"]-student_assess_merge[\"date\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 284,
   "metadata": {},
   "outputs": [],
   "source": [
    "group_student_assess_merge = student_assess_merge.groupby([\"id_student\",\"code_module\",\"code_presentation\"])\n",
    "\n",
    "# avg date of doing assessment before ddl\n",
    "avg_ahead_ddl = pd.DataFrame(group_student_assess_merge[\"sub_diff\"].mean())\n",
    "avg_ahead_ddl = avg_ahead_ddl.rename(columns={\"sub_diff\":\"avg_ahead_ddl\"})\n",
    "avg_ahead_ddl.reset_index(inplace=True)\n",
    "\n",
    "#  std of assessments\n",
    "std_assess_score = pd.DataFrame(group_student_assess_merge[\"score\"].std())\n",
    "std_assess_score = std_assess_score.rename(columns={\"score\":\"std_assess_score\"})\n",
    "std_assess_score.reset_index(inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Feature Integration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 285,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>highest_education</th>\n",
       "      <th>age_band</th>\n",
       "      <th>num_of_prev_attempts</th>\n",
       "      <th>disability</th>\n",
       "      <th>region_East Midlands Region</th>\n",
       "      <th>region_Ireland</th>\n",
       "      <th>region_London Region</th>\n",
       "      <th>region_North Region</th>\n",
       "      <th>region_North Western Region</th>\n",
       "      <th>...</th>\n",
       "      <th>Last Minite</th>\n",
       "      <th>Late Reg</th>\n",
       "      <th>Regular Reg</th>\n",
       "      <th>sum_click</th>\n",
       "      <th>learning_pattern</th>\n",
       "      <th>learning_pattern_1</th>\n",
       "      <th>learning_pattern_2</th>\n",
       "      <th>learning_pattern_3</th>\n",
       "      <th>avg_ahead_ddl</th>\n",
       "      <th>std_assess_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>934.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-1.800000</td>\n",
       "      <td>3.082207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1435.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>4.335897</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>281.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2158.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-2.000000</td>\n",
       "      <td>6.892024</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1034.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>11.400000</td>\n",
       "      <td>20.513410</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2445.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>10.977249</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1492.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>4.949747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1428.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.600000</td>\n",
       "      <td>0.547723</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1894.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.400000</td>\n",
       "      <td>2.607681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3158.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-4.600000</td>\n",
       "      <td>4.062019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1319.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-0.800000</td>\n",
       "      <td>5.656854</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1732.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>3.563706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1102.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-0.400000</td>\n",
       "      <td>9.864076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3388.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-2.600000</td>\n",
       "      <td>5.656854</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2737.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>16.742162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>171.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>1.414214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1053.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-4.600000</td>\n",
       "      <td>9.864076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2327.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-0.400000</td>\n",
       "      <td>4.393177</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>116.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.500000</td>\n",
       "      <td>21.641010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2992.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-0.600000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>680.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.800000</td>\n",
       "      <td>4.827007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1494.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.200000</td>\n",
       "      <td>7.758866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>339.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-2.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2839.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-7.800000</td>\n",
       "      <td>1.516575</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>744.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>4.277850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4104.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-1.800000</td>\n",
       "      <td>7.987490</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1944.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>10.677078</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1150.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-0.400000</td>\n",
       "      <td>5.412947</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4777.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.800000</td>\n",
       "      <td>3.209361</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>465.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>11.269428</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32562</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>727.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-76.500000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32563</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>986.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-10.000000</td>\n",
       "      <td>25.626089</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32564</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>545.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-30.444444</td>\n",
       "      <td>11.211353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32565</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>382.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-42.857143</td>\n",
       "      <td>16.293440</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32566</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>200.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>16.511179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32567</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1056.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-46.111111</td>\n",
       "      <td>10.540926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32568</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>232.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32569</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>410.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-45.666667</td>\n",
       "      <td>8.134290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32571</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>663.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-25.444444</td>\n",
       "      <td>22.616366</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32572</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1926.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-52.333333</td>\n",
       "      <td>18.027756</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32573</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>288.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.571429</td>\n",
       "      <td>19.669895</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32574</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>208.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32575</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1339.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-30.444444</td>\n",
       "      <td>14.743172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32576</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>51.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32577</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>118.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-4.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32578</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-81.500000</td>\n",
       "      <td>4.949747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32579</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>565.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-36.777778</td>\n",
       "      <td>17.756063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32580</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>230.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-7.875000</td>\n",
       "      <td>25.035689</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32581</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2151.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-63.333333</td>\n",
       "      <td>14.620761</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32582</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32583</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>598.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-42.555556</td>\n",
       "      <td>13.878441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32584</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>755.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-41.666667</td>\n",
       "      <td>16.853124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32585</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.222222</td>\n",
       "      <td>15.964370</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32586</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32587</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>476.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-31.444444</td>\n",
       "      <td>10.833333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32588</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32589</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>893.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-36.222222</td>\n",
       "      <td>11.580635</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32590</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>312.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-45.333333</td>\n",
       "      <td>15.206906</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32591</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>275.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-79.500000</td>\n",
       "      <td>12.020815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32592</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>616.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-50.428571</td>\n",
       "      <td>17.994708</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>29915 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       gender  highest_education  age_band  num_of_prev_attempts  disability  \\\n",
       "0           1                  3         2                     0           0   \n",
       "1           0                  3         1                     0           0   \n",
       "2           0                  2         1                     0           1   \n",
       "3           0                  2         1                     0           0   \n",
       "4           0                  1         0                     0           0   \n",
       "5           1                  2         1                     0           0   \n",
       "6           1                  3         0                     0           0   \n",
       "7           0                  2         0                     0           0   \n",
       "8           0                  2         0                     0           0   \n",
       "9           1                  4         2                     0           0   \n",
       "10          1                  1         1                     0           0   \n",
       "11          0                  2         0                     0           0   \n",
       "12          1                  1         1                     0           0   \n",
       "13          0                  3         0                     0           0   \n",
       "14          1                  1         1                     0           0   \n",
       "15          0                  2         0                     0           0   \n",
       "16          0                  2         1                     0           0   \n",
       "17          1                  3         1                     0           0   \n",
       "18          1                  2         1                     0           0   \n",
       "19          1                  2         1                     0           0   \n",
       "20          1                  2         0                     0           0   \n",
       "21          1                  3         0                     0           0   \n",
       "22          1                  1         1                     0           0   \n",
       "23          1                  1         1                     0           0   \n",
       "24          1                  2         0                     0           0   \n",
       "25          1                  1         1                     0           0   \n",
       "26          1                  2         0                     0           0   \n",
       "27          1                  3         0                     0           0   \n",
       "28          1                  4         1                     0           0   \n",
       "29          1                  3         1                     0           0   \n",
       "...       ...                ...       ...                   ...         ...   \n",
       "32562       0                  1         1                     0           0   \n",
       "32563       0                  1         1                     0           0   \n",
       "32564       0                  1         1                     0           0   \n",
       "32565       0                  1         0                     0           0   \n",
       "32566       0                  1         1                     0           0   \n",
       "32567       0                  2         1                     1           1   \n",
       "32568       0                  2         1                     0           0   \n",
       "32569       0                  2         1                     0           0   \n",
       "32571       0                  1         1                     0           0   \n",
       "32572       0                  1         1                     0           0   \n",
       "32573       0                  2         1                     0           0   \n",
       "32574       1                  2         1                     0           0   \n",
       "32575       0                  1         1                     0           0   \n",
       "32576       0                  2         1                     0           1   \n",
       "32577       1                  3         0                     0           0   \n",
       "32578       0                  1         1                     0           0   \n",
       "32579       1                  1         1                     0           0   \n",
       "32580       0                  2         1                     1           0   \n",
       "32581       0                  1         0                     0           1   \n",
       "32582       0                  1         1                     0           0   \n",
       "32583       0                  1         0                     0           0   \n",
       "32584       0                  1         0                     0           0   \n",
       "32585       0                  1         0                     0           0   \n",
       "32586       1                  3         1                     0           0   \n",
       "32587       0                  2         0                     0           1   \n",
       "32588       0                  1         0                     0           0   \n",
       "32589       0                  1         1                     0           0   \n",
       "32590       0                  2         0                     0           1   \n",
       "32591       0                  1         1                     0           0   \n",
       "32592       0                  3         1                     0           0   \n",
       "\n",
       "       region_East Midlands Region  region_Ireland  region_London Region  \\\n",
       "0                                0               0                     0   \n",
       "1                                0               0                     0   \n",
       "2                                0               0                     0   \n",
       "3                                0               0                     0   \n",
       "4                                0               0                     0   \n",
       "5                                0               0                     0   \n",
       "6                                0               0                     0   \n",
       "7                                0               0                     0   \n",
       "8                                0               0                     0   \n",
       "9                                0               0                     0   \n",
       "10                               0               0                     0   \n",
       "11                               0               0                     0   \n",
       "12                               0               0                     0   \n",
       "13                               0               0                     0   \n",
       "14                               0               0                     0   \n",
       "15                               0               0                     0   \n",
       "16                               0               0                     0   \n",
       "17                               0               1                     0   \n",
       "18                               0               0                     0   \n",
       "19                               0               0                     0   \n",
       "20                               1               0                     0   \n",
       "21                               0               0                     0   \n",
       "22                               0               0                     0   \n",
       "23                               0               0                     0   \n",
       "24                               0               0                     0   \n",
       "25                               0               0                     0   \n",
       "26                               0               0                     0   \n",
       "27                               0               0                     1   \n",
       "28                               0               1                     0   \n",
       "29                               0               0                     0   \n",
       "...                            ...             ...                   ...   \n",
       "32562                            0               0                     1   \n",
       "32563                            0               0                     0   \n",
       "32564                            0               0                     0   \n",
       "32565                            0               0                     0   \n",
       "32566                            0               0                     0   \n",
       "32567                            0               0                     0   \n",
       "32568                            0               0                     0   \n",
       "32569                            0               0                     0   \n",
       "32571                            0               0                     0   \n",
       "32572                            0               0                     0   \n",
       "32573                            0               0                     1   \n",
       "32574                            0               0                     0   \n",
       "32575                            0               0                     1   \n",
       "32576                            0               0                     0   \n",
       "32577                            0               1                     0   \n",
       "32578                            0               1                     0   \n",
       "32579                            1               0                     0   \n",
       "32580                            0               0                     0   \n",
       "32581                            0               0                     0   \n",
       "32582                            0               0                     0   \n",
       "32583                            1               0                     0   \n",
       "32584                            0               0                     0   \n",
       "32585                            0               0                     1   \n",
       "32586                            1               0                     0   \n",
       "32587                            0               0                     0   \n",
       "32588                            0               0                     0   \n",
       "32589                            0               0                     0   \n",
       "32590                            0               0                     0   \n",
       "32591                            0               0                     0   \n",
       "32592                            0               0                     0   \n",
       "\n",
       "       region_North Region  region_North Western Region  ...  Last Minite  \\\n",
       "0                        0                            0  ...            0   \n",
       "1                        0                            0  ...            0   \n",
       "2                        0                            1  ...            0   \n",
       "3                        0                            0  ...            0   \n",
       "4                        0                            0  ...            0   \n",
       "5                        0                            0  ...            0   \n",
       "6                        0                            0  ...            0   \n",
       "7                        0                            1  ...            0   \n",
       "8                        0                            0  ...            0   \n",
       "9                        1                            0  ...            0   \n",
       "10                       0                            0  ...            0   \n",
       "11                       0                            0  ...            0   \n",
       "12                       0                            0  ...            0   \n",
       "13                       0                            1  ...            0   \n",
       "14                       0                            0  ...            0   \n",
       "15                       0                            0  ...            0   \n",
       "16                       0                            0  ...            0   \n",
       "17                       0                            0  ...            0   \n",
       "18                       0                            0  ...            0   \n",
       "19                       0                            0  ...            0   \n",
       "20                       0                            0  ...            0   \n",
       "21                       0                            1  ...            0   \n",
       "22                       0                            0  ...            0   \n",
       "23                       0                            0  ...            0   \n",
       "24                       0                            0  ...            0   \n",
       "25                       0                            0  ...            0   \n",
       "26                       0                            1  ...            0   \n",
       "27                       0                            0  ...            0   \n",
       "28                       0                            0  ...            0   \n",
       "29                       0                            0  ...            0   \n",
       "...                    ...                          ...  ...          ...   \n",
       "32562                    0                            0  ...            0   \n",
       "32563                    0                            0  ...            0   \n",
       "32564                    0                            0  ...            0   \n",
       "32565                    0                            0  ...            0   \n",
       "32566                    0                            0  ...            0   \n",
       "32567                    0                            0  ...            0   \n",
       "32568                    0                            0  ...            0   \n",
       "32569                    0                            0  ...            0   \n",
       "32571                    0                            0  ...            0   \n",
       "32572                    0                            0  ...            0   \n",
       "32573                    0                            0  ...            0   \n",
       "32574                    0                            0  ...            0   \n",
       "32575                    0                            0  ...            0   \n",
       "32576                    0                            0  ...            0   \n",
       "32577                    0                            0  ...            0   \n",
       "32578                    0                            0  ...            0   \n",
       "32579                    0                            0  ...            0   \n",
       "32580                    0                            0  ...            0   \n",
       "32581                    0                            0  ...            0   \n",
       "32582                    0                            0  ...            0   \n",
       "32583                    0                            0  ...            0   \n",
       "32584                    0                            0  ...            0   \n",
       "32585                    0                            0  ...            0   \n",
       "32586                    0                            0  ...            0   \n",
       "32587                    0                            0  ...            0   \n",
       "32588                    0                            0  ...            0   \n",
       "32589                    0                            0  ...            0   \n",
       "32590                    0                            0  ...            0   \n",
       "32591                    0                            0  ...            0   \n",
       "32592                    0                            0  ...            0   \n",
       "\n",
       "       Late Reg  Regular Reg  sum_click  learning_pattern  learning_pattern_1  \\\n",
       "0             0            0      934.0               0.0                 0.0   \n",
       "1             0            0     1435.0               3.0                 0.0   \n",
       "2             0            0      281.0               1.0                 1.0   \n",
       "3             0            0     2158.0               0.0                 0.0   \n",
       "4             0            0     1034.0               3.0                 0.0   \n",
       "5             0            0     2445.0               3.0                 0.0   \n",
       "6             0            0     1492.0               2.0                 0.0   \n",
       "7             0            1     1428.0               3.0                 0.0   \n",
       "8             0            0     1894.0               3.0                 0.0   \n",
       "9             0            0     3158.0               3.0                 0.0   \n",
       "10            0            0     1319.0               0.0                 0.0   \n",
       "11            0            0     1732.0               0.0                 0.0   \n",
       "12            0            0     1102.0               3.0                 0.0   \n",
       "13            0            0     3388.0               2.0                 0.0   \n",
       "14            0            0     2737.0               3.0                 0.0   \n",
       "15            0            0      171.0               2.0                 0.0   \n",
       "16            0            0     1053.0               1.0                 1.0   \n",
       "17            0            0     2327.0               2.0                 0.0   \n",
       "18            0            0      116.0               2.0                 0.0   \n",
       "19            0            0     2992.0               1.0                 1.0   \n",
       "20            0            1      680.0               3.0                 0.0   \n",
       "21            0            0     1494.0               0.0                 0.0   \n",
       "22            0            0      339.0               0.0                 0.0   \n",
       "23            0            0     2839.0               0.0                 0.0   \n",
       "24            0            0      744.0               3.0                 0.0   \n",
       "25            0            0     4104.0               2.0                 0.0   \n",
       "26            0            0     1944.0               0.0                 0.0   \n",
       "27            0            0     1150.0               2.0                 0.0   \n",
       "28            0            0     4777.0               3.0                 0.0   \n",
       "29            0            1      465.0               3.0                 0.0   \n",
       "...         ...          ...        ...               ...                 ...   \n",
       "32562         0            0      727.0               3.0                 0.0   \n",
       "32563         0            1      986.0               3.0                 0.0   \n",
       "32564         0            0      545.0               3.0                 0.0   \n",
       "32565         0            0      382.0               3.0                 0.0   \n",
       "32566         0            1      200.0               3.0                 0.0   \n",
       "32567         0            0     1056.0               3.0                 0.0   \n",
       "32568         0            1      232.0               1.0                 1.0   \n",
       "32569         0            1      410.0               3.0                 0.0   \n",
       "32571         0            0      663.0               3.0                 0.0   \n",
       "32572         0            1     1926.0               1.0                 1.0   \n",
       "32573         0            1      288.0               1.0                 1.0   \n",
       "32574         0            0      208.0               3.0                 0.0   \n",
       "32575         0            0     1339.0               1.0                 1.0   \n",
       "32576         0            1       51.0               0.0                 0.0   \n",
       "32577         0            0      118.0               0.0                 0.0   \n",
       "32578         0            0       58.0               0.0                 0.0   \n",
       "32579         0            0      565.0               3.0                 0.0   \n",
       "32580         0            0      230.0               3.0                 0.0   \n",
       "32581         0            0     2151.0               3.0                 0.0   \n",
       "32582         0            0        9.0               1.0                 1.0   \n",
       "32583         0            0      598.0               1.0                 1.0   \n",
       "32584         0            0      755.0               1.0                 1.0   \n",
       "32585         0            0      236.0               3.0                 0.0   \n",
       "32586         0            0       37.0               3.0                 0.0   \n",
       "32587         0            1      476.0               0.0                 0.0   \n",
       "32588         0            1       41.0               1.0                 1.0   \n",
       "32589         0            1      893.0               3.0                 0.0   \n",
       "32590         0            0      312.0               0.0                 0.0   \n",
       "32591         0            0      275.0               1.0                 1.0   \n",
       "32592         0            1      616.0               0.0                 0.0   \n",
       "\n",
       "       learning_pattern_2 learning_pattern_3  avg_ahead_ddl  std_assess_score  \n",
       "0                     0.0                0.0      -1.800000          3.082207  \n",
       "1                     0.0                1.0       0.000000          4.335897  \n",
       "2                     0.0                0.0            NaN               NaN  \n",
       "3                     0.0                0.0      -2.000000          6.892024  \n",
       "4                     0.0                1.0      11.400000         20.513410  \n",
       "5                     0.0                1.0       2.000000         10.977249  \n",
       "6                     1.0                0.0       0.400000          4.949747  \n",
       "7                     0.0                1.0       2.600000          0.547723  \n",
       "8                     0.0                1.0       1.400000          2.607681  \n",
       "9                     0.0                1.0      -4.600000          4.062019  \n",
       "10                    0.0                0.0      -0.800000          5.656854  \n",
       "11                    0.0                0.0       0.400000          3.563706  \n",
       "12                    0.0                1.0      -0.400000          9.864076  \n",
       "13                    1.0                0.0      -2.600000          5.656854  \n",
       "14                    0.0                1.0       0.000000         16.742162  \n",
       "15                    1.0                0.0      -2.500000          1.414214  \n",
       "16                    0.0                0.0      -4.600000          9.864076  \n",
       "17                    1.0                0.0      -0.400000          4.393177  \n",
       "18                    1.0                0.0       1.500000         21.641010  \n",
       "19                    0.0                0.0      -0.600000          1.000000  \n",
       "20                    0.0                1.0       0.800000          4.827007  \n",
       "21                    0.0                0.0       5.200000          7.758866  \n",
       "22                    0.0                0.0      -2.000000               NaN  \n",
       "23                    0.0                0.0      -7.800000          1.516575  \n",
       "24                    0.0                1.0       0.200000          4.277850  \n",
       "25                    1.0                0.0      -1.800000          7.987490  \n",
       "26                    0.0                0.0       0.000000         10.677078  \n",
       "27                    1.0                0.0      -0.400000          5.412947  \n",
       "28                    0.0                1.0       3.800000          3.209361  \n",
       "29                    0.0                1.0       7.000000         11.269428  \n",
       "...                   ...                ...            ...               ...  \n",
       "32562                 0.0                1.0     -76.500000          0.000000  \n",
       "32563                 0.0                1.0     -10.000000         25.626089  \n",
       "32564                 0.0                1.0     -30.444444         11.211353  \n",
       "32565                 0.0                1.0     -42.857143         16.293440  \n",
       "32566                 0.0                1.0       1.000000         16.511179  \n",
       "32567                 0.0                1.0     -46.111111         10.540926  \n",
       "32568                 0.0                0.0       6.000000               NaN  \n",
       "32569                 0.0                1.0     -45.666667          8.134290  \n",
       "32571                 0.0                1.0     -25.444444         22.616366  \n",
       "32572                 0.0                0.0     -52.333333         18.027756  \n",
       "32573                 0.0                0.0       2.571429         19.669895  \n",
       "32574                 0.0                1.0            NaN               NaN  \n",
       "32575                 0.0                0.0     -30.444444         14.743172  \n",
       "32576                 0.0                0.0            NaN               NaN  \n",
       "32577                 0.0                0.0      -4.000000               NaN  \n",
       "32578                 0.0                0.0     -81.500000          4.949747  \n",
       "32579                 0.0                1.0     -36.777778         17.756063  \n",
       "32580                 0.0                1.0      -7.875000         25.035689  \n",
       "32581                 0.0                1.0     -63.333333         14.620761  \n",
       "32582                 0.0                0.0            NaN               NaN  \n",
       "32583                 0.0                0.0     -42.555556         13.878441  \n",
       "32584                 0.0                0.0     -41.666667         16.853124  \n",
       "32585                 0.0                1.0       0.222222         15.964370  \n",
       "32586                 0.0                1.0            NaN               NaN  \n",
       "32587                 0.0                0.0     -31.444444         10.833333  \n",
       "32588                 0.0                0.0            NaN               NaN  \n",
       "32589                 0.0                1.0     -36.222222         11.580635  \n",
       "32590                 0.0                0.0     -45.333333         15.206906  \n",
       "32591                 0.0                0.0     -79.500000         12.020815  \n",
       "32592                 0.0                0.0     -50.428571         17.994708  \n",
       "\n",
       "[29915 rows x 28 columns]"
      ]
     },
     "execution_count": 285,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feature_set = student_info_feature.join(student_reg_feature,how='left')\n",
    "feature_set = feature_set.join(vle_feature,how='left')\n",
    "feature_set = pd.merge(feature_set,avg_ahead_ddl,how=\"left\",on=[\"code_module\",\"code_presentation\",\"id_student\"])\n",
    "feature_set = pd.merge(feature_set,std_assess_score,how=\"left\",on=[\"code_module\",\"code_presentation\",\"id_student\"])\n",
    "\n",
    "# drop students unregistered before course begins\n",
    "feature_set = feature_set[~(feature_set['date_unregistration']<0)]\n",
    "# drop col unreg date\n",
    "feature_set.drop(['date_unregistration',\"code_module\",\"code_presentation\",\"id_student\"],axis=1,inplace=True)\n",
    "feature_set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['gender', 'highest_education', 'age_band', 'num_of_prev_attempts',\n",
       "       'disability', 'region_East Midlands Region', 'region_Ireland',\n",
       "       'region_London Region', 'region_North Region',\n",
       "       'region_North Western Region', 'region_Scotland',\n",
       "       'region_South East Region', 'region_South Region',\n",
       "       'region_South West Region', 'region_Wales',\n",
       "       'region_West Midlands Region', 'region_Yorkshire Region',\n",
       "       'final_result', 'Last Minite', 'Late Reg', 'Regular Reg', 'sum_click',\n",
       "       'learning_pattern', 'learning_pattern_1', 'learning_pattern_2',\n",
       "       'learning_pattern_3', 'avg_ahead_ddl', 'std_assess_score'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 229,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feature_set.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Machine Learning\n",
    "- Logistic regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  This is separate from the ipykernel package so we can avoid doing imports until\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Pass    15385\n",
       "Fail    14530\n",
       "Name: final_result, dtype: int64"
      ]
     },
     "execution_count": 249,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# change to binary - pass/fail\n",
    "feature_set_binary = feature_set.copy()\n",
    "feature_set_binary['final_result'][feature_set_binary['final_result']=='Withdrawn'] = 'Fail'\n",
    "feature_set_binary['final_result'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_model_set(df,dropna=True,test_size=0.25):\n",
    "    if dropna: \n",
    "        df = df.dropna()\n",
    "    # train test split\n",
    "    train, test = train_test_split(df,test_size=test_size)\n",
    "    # seperate x and y\n",
    "    y_train = train['final_result']\n",
    "    x_train = train.drop('final_result',axis=1)\n",
    "    y_test = test['final_result']\n",
    "    x_test = test.drop('final_result',axis=1)\n",
    "    return x_train,y_train,x_test,y_test"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Logistic regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\n",
      "  FutureWarning)\n",
      "/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:460: FutureWarning: Default multi_class will be changed to 'auto' in 0.22. Specify the multi_class option to silence this warning.\n",
      "  \"this warning.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.67463456577816\n",
      "Logistic regression accuracy:\n"
     ]
    }
   ],
   "source": [
    "# y - 3 classes\n",
    "x_train,y_train,x_test,y_test = get_model_set(feature_set,dropna=True,test_size=0.25)\n",
    "\n",
    "logistic_model = LogisticRegression()\n",
    "logistic_model.fit(x_train,y_train)\n",
    "\n",
    "# predict on test data\n",
    "train_acc = metrics.accuracy_score(y_train,logistic_model.predict(x_train))\n",
    "test_acc = metrics.accuracy_score(y_test,logistic_model.predict(x_test))\n",
    "print(test_acc)\n",
    "print('Logistic regression accuracy:')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 276,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Feature</th>\n",
       "      <th>Coefficient</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>gender</td>\n",
       "      <td>-0.626115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>highest_education</td>\n",
       "      <td>0.273360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>age_band</td>\n",
       "      <td>-0.002779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>num_of_prev_attempts</td>\n",
       "      <td>-0.385890</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>disability</td>\n",
       "      <td>-0.257326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>region_East Midlands Region</td>\n",
       "      <td>0.055809</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>region_Ireland</td>\n",
       "      <td>0.013790</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>region_London Region</td>\n",
       "      <td>-0.153304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>region_North Region</td>\n",
       "      <td>-0.021866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>region_North Western Region</td>\n",
       "      <td>-0.178268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>region_Scotland</td>\n",
       "      <td>-0.217835</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>region_South East Region</td>\n",
       "      <td>0.231227</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>region_South Region</td>\n",
       "      <td>0.156263</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>region_South West Region</td>\n",
       "      <td>0.149149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>region_Wales</td>\n",
       "      <td>-0.113851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>region_West Midlands Region</td>\n",
       "      <td>-0.048416</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>region_Yorkshire Region</td>\n",
       "      <td>-0.006367</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Last Minite</td>\n",
       "      <td>-0.002216</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Late Reg</td>\n",
       "      <td>0.007915</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Regular Reg</td>\n",
       "      <td>0.059279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>sum_click</td>\n",
       "      <td>0.000820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>learning_pattern</td>\n",
       "      <td>-0.007326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>learning_pattern_1</td>\n",
       "      <td>-0.027091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>learning_pattern_2</td>\n",
       "      <td>0.074958</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>learning_pattern_3</td>\n",
       "      <td>-0.043383</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>avg_ahead_ddl</td>\n",
       "      <td>0.005651</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>std_assess_score</td>\n",
       "      <td>-0.029036</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        Feature  Coefficient\n",
       "0                        gender    -0.626115\n",
       "1             highest_education     0.273360\n",
       "2                      age_band    -0.002779\n",
       "3          num_of_prev_attempts    -0.385890\n",
       "4                    disability    -0.257326\n",
       "5   region_East Midlands Region     0.055809\n",
       "6                region_Ireland     0.013790\n",
       "7          region_London Region    -0.153304\n",
       "8           region_North Region    -0.021866\n",
       "9   region_North Western Region    -0.178268\n",
       "10              region_Scotland    -0.217835\n",
       "11     region_South East Region     0.231227\n",
       "12          region_South Region     0.156263\n",
       "13     region_South West Region     0.149149\n",
       "14                 region_Wales    -0.113851\n",
       "15  region_West Midlands Region    -0.048416\n",
       "16      region_Yorkshire Region    -0.006367\n",
       "17                  Last Minite    -0.002216\n",
       "18                     Late Reg     0.007915\n",
       "19                  Regular Reg     0.059279\n",
       "20                    sum_click     0.000820\n",
       "21             learning_pattern    -0.007326\n",
       "22           learning_pattern_1    -0.027091\n",
       "23           learning_pattern_2     0.074958\n",
       "24           learning_pattern_3    -0.043383\n",
       "25                avg_ahead_ddl     0.005651\n",
       "26             std_assess_score    -0.029036"
      ]
     },
     "execution_count": 276,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# result analysis\n",
    "feature_name = list(x_train.columns)\n",
    "coef = logistic_model.coef_.tolist()\n",
    "mapped = list(zip(feature_name,coef[0]))\n",
    "pd.DataFrame(mapped,columns=['Feature','Coefficient'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7338913093327218\n",
      "0.7349957007738607\n",
      "Logistic regression accuracy:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\n",
      "  FutureWarning)\n"
     ]
    }
   ],
   "source": [
    "# y - 2 classes\n",
    "x_train,y_train,x_test,y_test = get_model_set(feature_set_binary,dropna=True,test_size=0.25)\n",
    "\n",
    "logistic_model = LogisticRegression()\n",
    "logistic_model.fit(x_train,y_train)\n",
    "\n",
    "# predict on test data\n",
    "train_acc = metrics.accuracy_score(y_train,logistic_model.predict(x_train))\n",
    "test_acc = metrics.accuracy_score(y_test,logistic_model.predict(x_test))\n",
    "print(train_acc)\n",
    "print(test_acc)\n",
    "print('Logistic regression accuracy:')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def logistic_regression(df):\n",
    "    x_train,y_train,x_test,y_test = get_machine_learning_dataset(df,normalize=True,pca=False)\n",
    "\n",
    "    score = metrics.accuracy_score(y_test,model.predict(x_test))\n",
    "    print('Logistic regression accuracy:',score)\n",
    "    return model,score"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Reference"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Pass         0.514290\n",
       "Withdrawn    0.250042\n",
       "Fail         0.235668\n",
       "Name: final_result, dtype: float64"
      ]
     },
     "execution_count": 143,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# y distribution\n",
    "feature_set['final_result'].value_counts()/len(feature_set)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
